{"ast":null,"code":"import { createTextVNode as _createTextVNode, resolveComponent as _resolveComponent, withCtx as _withCtx, createVNode as _createVNode, toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, createCommentVNode as _createCommentVNode, vShow as _vShow, withDirectives as _withDirectives, openBlock as _openBlock, createElementBlock as _createElementBlock, renderList as _renderList, Fragment as _Fragment, createBlock as _createBlock, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\";\nconst _withScopeId = n => (_pushScopeId(\"data-v-74e39d9a\"), n = n(), _popScopeId(), n);\nconst _hoisted_1 = {\n  class: \"bg\"\n};\nconst _hoisted_2 = {\n  class: \"info-edit-master\"\n};\nconst _hoisted_3 = /*#__PURE__*/_createTextVNode(\"返回我的主页>\");\nconst _hoisted_4 = {\n  class: \"edit-top\"\n};\nconst _hoisted_5 = {\n  class: \"username-div\"\n};\nconst _hoisted_6 = {\n  class: \"edit-bottom\"\n};\nconst _hoisted_7 = {\n  class: \"nickname-div\"\n};\nconst _hoisted_8 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"div\", {\n  class: \"like\"\n}, \"昵称\", -1 /* HOISTED */));\nconst _hoisted_9 = {\n  class: \"content\"\n};\nconst _hoisted_10 = {\n  class: \"each\"\n};\nconst _hoisted_11 = /*#__PURE__*/_createTextVNode(\"修改 \");\nconst _hoisted_12 = {\n  class: \"editing\"\n};\nconst _hoisted_13 = /*#__PURE__*/_createTextVNode(\"保存\");\nconst _hoisted_14 = /*#__PURE__*/_createTextVNode(\"取消\");\nconst _hoisted_15 = {\n  class: \"sex\"\n};\nconst _hoisted_16 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"div\", {\n  class: \"like\"\n}, \"性别\", -1 /* HOISTED */));\nconst _hoisted_17 = {\n  class: \"content\"\n};\nconst _hoisted_18 = {\n  class: \"each\"\n};\nconst _hoisted_19 = {\n  key: 0\n};\nconst _hoisted_20 = {\n  key: 1\n};\nconst _hoisted_21 = {\n  key: 2\n};\nconst _hoisted_22 = /*#__PURE__*/_createTextVNode(\"修改 \");\nconst _hoisted_23 = {\n  class: \"editing\"\n};\nconst _hoisted_24 = /*#__PURE__*/_createTextVNode(\"男\");\nconst _hoisted_25 = /*#__PURE__*/_createTextVNode(\"女\");\nconst _hoisted_26 = /*#__PURE__*/_createTextVNode(\"保密\");\nconst _hoisted_27 = /*#__PURE__*/_createTextVNode(\"保存\");\nconst _hoisted_28 = /*#__PURE__*/_createTextVNode(\"取消\");\nconst _hoisted_29 = {\n  class: \"types\"\n};\nconst _hoisted_30 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"div\", {\n  class: \"like\"\n}, \"类型喜好\", -1 /* HOISTED */));\nconst _hoisted_31 = {\n  class: \"regions\"\n};\nconst _hoisted_32 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"div\", {\n  class: \"like\"\n}, \"地区喜好\", -1 /* HOISTED */));\n\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_router_link = _resolveComponent(\"router-link\");\n  const _component_avatar_edit = _resolveComponent(\"avatar-edit\");\n  const _component_el_divider = _resolveComponent(\"el-divider\");\n  const _component_edit = _resolveComponent(\"edit\");\n  const _component_el_icon = _resolveComponent(\"el-icon\");\n  const _component_el_input = _resolveComponent(\"el-input\");\n  const _component_el_button = _resolveComponent(\"el-button\");\n  const _component_el_radio = _resolveComponent(\"el-radio\");\n  const _component_el_radio_group = _resolveComponent(\"el-radio-group\");\n  const _component_el_tag = _resolveComponent(\"el-tag\");\n  const _component_like_editing = _resolveComponent(\"like-editing\");\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createElementVNode(\"div\", _hoisted_2, [_createVNode(_component_router_link, {\n    to: \"/personal\",\n    class: \"back-to-my-home\"\n  }, {\n    default: _withCtx(() => [_hoisted_3]),\n    _: 1 /* STABLE */\n  }), _createElementVNode(\"div\", _hoisted_4, [_createVNode(_component_avatar_edit, {\n    size: 12,\n    class: \"avatar\"\n  }), _createElementVNode(\"div\", _hoisted_5, _toDisplayString($setup.user.username), 1 /* TEXT */)]), _createElementVNode(\"div\", _hoisted_6, [_createVNode(_component_el_divider), _createElementVNode(\"div\", _hoisted_7, [_hoisted_8, _createCommentVNode(\" 昵称展示 \"), _withDirectives(_createElementVNode(\"div\", _hoisted_9, [_createElementVNode(\"span\", _hoisted_10, _toDisplayString($setup.user.nickname), 1 /* TEXT */), _createElementVNode(\"span\", {\n    onClick: _cache[0] || (_cache[0] = $event => $setup.isShowNickname = !$setup.isShowNickname),\n    class: \"edit-btn\"\n  }, [_createVNode(_component_el_icon, null, {\n    default: _withCtx(() => [_createVNode(_component_edit)]),\n    _: 1 /* STABLE */\n  }), _hoisted_11])], 512 /* NEED_PATCH */), [[_vShow, !$setup.isShowNickname]]), _createCommentVNode(\" 昵称编辑 \"), _withDirectives(_createElementVNode(\"div\", _hoisted_12, [_createVNode(_component_el_input, {\n    maxlength: \"10\",\n    placeholder: \"请输入更新后的昵称\",\n    \"show-word-limit\": \"\",\n    modelValue: $setup.newNickname,\n    \"onUpdate:modelValue\": _cache[1] || (_cache[1] = $event => $setup.newNickname = $event),\n    clearable: \"\",\n    class: \"editing-input\"\n  }, null, 8 /* PROPS */, [\"modelValue\"]), _createVNode(_component_el_button, {\n    onClick: $setup.handleUpdateNickname,\n    type: \"primary\",\n    class: \"editing-btn\"\n  }, {\n    default: _withCtx(() => [_hoisted_13]),\n    _: 1 /* STABLE */\n  }, 8 /* PROPS */, [\"onClick\"]), _createVNode(_component_el_button, {\n    onClick: _cache[2] || (_cache[2] = $event => $setup.isShowNickname = !$setup.isShowNickname),\n    class: \"editing-btn\"\n  }, {\n    default: _withCtx(() => [_hoisted_14]),\n    _: 1 /* STABLE */\n  })], 512 /* NEED_PATCH */), [[_vShow, $setup.isShowNickname]])]), _createVNode(_component_el_divider), _createElementVNode(\"div\", _hoisted_15, [_hoisted_16, _createCommentVNode(\" 性别展示 \"), _withDirectives(_createElementVNode(\"div\", _hoisted_17, [_createElementVNode(\"span\", _hoisted_18, [$setup.user.sex === '男' ? (_openBlock(), _createElementBlock(\"span\", _hoisted_19, \"男\")) : $setup.user.sex === '女' ? (_openBlock(), _createElementBlock(\"span\", _hoisted_20, \"女\")) : (_openBlock(), _createElementBlock(\"span\", _hoisted_21, \"保密\"))]), _createElementVNode(\"span\", {\n    onClick: _cache[3] || (_cache[3] = $event => $setup.isShowSex = !$setup.isShowSex),\n    class: \"edit-btn\"\n  }, [_createVNode(_component_el_icon, null, {\n    default: _withCtx(() => [_createVNode(_component_edit)]),\n    _: 1 /* STABLE */\n  }), _hoisted_22])], 512 /* NEED_PATCH */), [[_vShow, !$setup.isShowSex]]), _createCommentVNode(\" 性别编辑 \"), _withDirectives(_createElementVNode(\"div\", _hoisted_23, [_createVNode(_component_el_radio_group, {\n    class: \"editing-input\",\n    modelValue: $setup.newSex,\n    \"onUpdate:modelValue\": _cache[4] || (_cache[4] = $event => $setup.newSex = $event)\n  }, {\n    default: _withCtx(() => [_createVNode(_component_el_radio, {\n      label: \"男\"\n    }, {\n      default: _withCtx(() => [_hoisted_24]),\n      _: 1 /* STABLE */\n    }), _createVNode(_component_el_radio, {\n      label: \"女\"\n    }, {\n      default: _withCtx(() => [_hoisted_25]),\n      _: 1 /* STABLE */\n    }), _createVNode(_component_el_radio, {\n      label: \"保密\"\n    }, {\n      default: _withCtx(() => [_hoisted_26]),\n      _: 1 /* STABLE */\n    })]),\n\n    _: 1 /* STABLE */\n  }, 8 /* PROPS */, [\"modelValue\"]), _createElementVNode(\"div\", null, [_createVNode(_component_el_button, {\n    onClick: $setup.handleUpdateSex,\n    type: \"primary\",\n    class: \"editing-btn\"\n  }, {\n    default: _withCtx(() => [_hoisted_27]),\n    _: 1 /* STABLE */\n  }, 8 /* PROPS */, [\"onClick\"]), _createVNode(_component_el_button, {\n    onClick: _cache[5] || (_cache[5] = $event => $setup.isShowSex = !$setup.isShowSex),\n    class: \"editing-btn\"\n  }, {\n    default: _withCtx(() => [_hoisted_28]),\n    _: 1 /* STABLE */\n  })])], 512 /* NEED_PATCH */), [[_vShow, $setup.isShowSex]])]), _createVNode(_component_el_divider), _createElementVNode(\"div\", _hoisted_29, [_hoisted_30, (_openBlock(true), _createElementBlock(_Fragment, null, _renderList($setup.types, (type, index) => {\n    return _openBlock(), _createBlock(_component_el_tag, {\n      key: index,\n      class: \"each\",\n      type: \"info\",\n      effect: \"dark\"\n    }, {\n      default: _withCtx(() => [_createTextVNode(_toDisplayString(type), 1 /* TEXT */)]),\n\n      _: 2 /* DYNAMIC */\n    }, 1024 /* DYNAMIC_SLOTS */);\n  }), 128 /* KEYED_FRAGMENT */)), _createVNode(_component_like_editing, {\n    opt: 1,\n    likes: $setup.types\n  }, null, 8 /* PROPS */, [\"likes\"])]), _createVNode(_component_el_divider), _createElementVNode(\"div\", _hoisted_31, [_hoisted_32, (_openBlock(true), _createElementBlock(_Fragment, null, _renderList($setup.regions, (region, index) => {\n    return _openBlock(), _createBlock(_component_el_tag, {\n      key: index,\n      class: \"each\",\n      type: \"info\",\n      effect: \"dark\"\n    }, {\n      default: _withCtx(() => [_createTextVNode(_toDisplayString(region), 1 /* TEXT */)]),\n\n      _: 2 /* DYNAMIC */\n    }, 1024 /* DYNAMIC_SLOTS */);\n  }), 128 /* KEYED_FRAGMENT */)), _createVNode(_component_like_editing, {\n    opt: 2,\n    likes: $setup.regions\n  }, null, 8 /* PROPS */, [\"likes\"])]), _createVNode(_component_el_divider)])])]);\n}","map":{"version":3,"mappings":";;;EACOA,KAAK,EAAC;AAAI;;EACRA,KAAK,EAAC;AAAkB;iDACyB,SAAO;;EAEtDA,KAAK,EAAC;AAAU;;EAEdA,KAAK,EAAC;AAAc;;EAGtBA,KAAK,EAAC;AAAa;;EAGjBA,KAAK,EAAC;AAAc;gEACvBC,oBAA0B;EAArBD,KAAK,EAAC;AAAM,GAAC,IAAE;;EAEUA,KAAK,EAAC;AAAS;;EACrCA,KAAK,EAAC;AAAM;kDAEQ,KAC5B;;EAI6BA,KAAK,EAAC;AAAS;kDAQkC,IAAE;kDACL,IAAE;;EAM1EA,KAAK,EAAC;AAAK;iEACdC,oBAA0B;EAArBD,KAAK,EAAC;AAAM,GAAC,IAAE;;EAEKA,KAAK,EAAC;AAAS;;EAChCA,KAAK,EAAC;AAAM;;;;;;;;;;kDAMU,KAC5B;;EAGsBA,KAAK,EAAC;AAAS;kDAEf,GAAC;kDACD,GAAC;kDACA,IAAE;kDAGgD,IAAE;kDACV,IAAE;;EAOlEA,KAAK,EAAC;AAAO;iEAChBC,oBAA4B;EAAvBD,KAAK,EAAC;AAAM,GAAC,MAAI;;EAiBnBA,KAAK,EAAC;AAAS;iEAClBC,oBAA4B;EAAvBD,KAAK,EAAC;AAAM,GAAC,MAAI;;;;;;;;;;;;;;uBAtF9BE,oBAwGM,OAxGNC,UAwGM,GAvGJF,oBAsGM,OAtGNG,UAsGM,GArGJC,aAAyEC;IAA5DC,EAAE,EAAC,WAAW;IAACP,KAAK,EAAC;;sBAAkB,MAAO;;MAE3DC,oBAGM,OAHNO,UAGM,GAFJH,aAAqDI;IAAvCC,IAAI,EAAE,EAAE;IAAEV,KAAK,EAAC;MAC9BC,oBAAmD,OAAnDU,UAAmD,mBAAtBC,WAAI,CAACC,QAAQ,oBAG5CZ,oBA6FM,OA7FNa,UA6FM,GA5FJT,aAAaU,wBAEbd,oBAsBM,OAtBNe,UAsBM,GArBJC,UAA0B,EAC1BC,6BAAa,kBACbjB,oBAKM,OALNkB,UAKM,GAJJlB,oBAA6C,QAA7CmB,WAA6C,mBAAvBR,WAAI,CAACS,QAAQ,kBACnCpB,oBAEK;IAFEqB,OAAK,sCAAEV,qBAAc,IAAIA,qBAAc;IAAEZ,KAAK,EAAC;MACtDK,aAA0BkB;sBAAjB,MAAO,CAAPlB,aAAOmB;;wDAHJZ,qBAAc,KAO5BM,6BAAa,kBACbjB,oBAUM,OAVNwB,WAUM,GATJpB,aAMWqB;IALPC,SAAS,EAAC,IAAI;IACdC,WAAW,EAAC,WAAW;IACvB,iBAAe,EAAf,EAAe;gBACNhB,kBAAW;+DAAXA,kBAAW;IAAEiB,SAAS,EAAT,EAAS;IAC/B7B,KAAK,EAAC;2CAEVK,aAA0FyB;IAA9ER,OAAK,EAAEV,2BAAoB;IAAEmB,IAAI,EAAC,SAAS;IAAC/B,KAAK,EAAC;;sBAAc,MAAE;;kCAC9EK,aAAuFyB;IAA3ER,OAAK,sCAAEV,qBAAc,IAAIA,qBAAc;IAAEZ,KAAK,EAAC;;sBAAc,MAAE;;wCAThEY,qBAAc,OAa7BP,aAAaU,wBAEbd,oBAyBM,OAzBN+B,WAyBM,GAxBJC,WAA0B,EAC1Bf,6BAAa,kBACbjB,oBASM,OATNiC,WASM,GARJjC,oBAIO,QAJPkC,WAIO,GAHOvB,WAAI,CAACwB,GAAG,0BAApBlC,oBAAsC,qBAAR,GAAC,KACdU,WAAI,CAACwB,GAAG,0BAAzBlC,oBAA2C,qBAAR,GAAC,oBACpCA,oBAAsB,qBAAT,IAAE,MAEjBD,oBAEO;IAFAqB,OAAK,sCAAEV,gBAAS,IAAIA,gBAAS;IAAEZ,KAAK,EAAC;MAC1CK,aAA0BkB;sBAAjB,MAAO,CAAPlB,aAAOmB;;wDAPNZ,gBAAS,KAUvBM,6BAAa,kBACbjB,oBAUM,OAVNoC,WAUM,GATJhC,aAIiBiC;IAJDtC,KAAK,EAAC,eAAe;gBAAUY,aAAM;+DAANA,aAAM;;sBACnD,MAAgC,CAAhCP,aAAgCkC;MAAtBC,KAAK,EAAC;IAAG;wBAAC,MAAC;;QACrBnC,aAAgCkC;MAAtBC,KAAK,EAAC;IAAG;wBAAC,MAAC;;QACrBnC,aAAkCkC;MAAxBC,KAAK,EAAC;IAAI;wBAAC,MAAE;;;;;qCAEzBvC,oBAGM,cAFJI,aAAqFyB;IAAzER,OAAK,EAAEV,sBAAe;IAAEmB,IAAI,EAAC,SAAS;IAAC/B,KAAK,EAAC;;sBAAc,MAAE;;kCACzEK,aAA6EyB;IAAjER,OAAK,sCAAEV,gBAAS,IAAIA,gBAAS;IAAEZ,KAAK,EAAC;;sBAAc,MAAE;;0CARxDY,gBAAS,OAaxBP,aAAaU,wBAEbd,oBAcM,OAdNwC,WAcM,GAbJC,WAA4B,qBAC5BxC,oBAQSyC,6BAPmB/B,YAAK,GAArBmB,IAAI,EAAEa,KAAK;yBADvBC,aAQSC;MANJC,GAAG,EAAEH,KAAK;MACX5C,KAAK,EAAC,MAAM;MACZ+B,IAAI,EAAC,MAAM;MACXiB,MAAM,EAAC;;wBAET,MAAU,mCAAPjB,IAAI;;;;kCAGT1B,aAC8B4C;IADfC,GAAG,EAAE,CAAC;IACNC,KAAK,EAAEvC;wCAGxBP,aAAaU,wBAEbd,oBAcM,OAdNmD,WAcM,GAbJC,WAA4B,qBAC5BnD,oBAQSyC,6BAPqB/B,cAAO,GAAzB0C,MAAM,EAAEV,KAAK;yBADzBC,aAQSC;MANJC,GAAG,EAAEH,KAAK;MACX5C,KAAK,EAAC,MAAM;MACZ+B,IAAI,EAAC,MAAM;MACXiB,MAAM,EAAC;;wBAET,MAAY,mCAATM,MAAM;;;;kCAGXjD,aACgC4C;IADjBC,GAAG,EAAE,CAAC;IACNC,KAAK,EAAEvC;wCAGxBP,aAAaU","names":["class","_createElementVNode","_createElementBlock","_hoisted_1","_hoisted_2","_createVNode","_component_router_link","to","_hoisted_4","_component_avatar_edit","size","_hoisted_5","$setup","username","_hoisted_6","_component_el_divider","_hoisted_7","_hoisted_8","_createCommentVNode","_hoisted_9","_hoisted_10","nickname","onClick","_component_el_icon","_component_edit","_hoisted_12","_component_el_input","maxlength","placeholder","clearable","_component_el_button","type","_hoisted_15","_hoisted_16","_hoisted_17","_hoisted_18","sex","_hoisted_23","_component_el_radio_group","_component_el_radio","label","_hoisted_29","_hoisted_30","_Fragment","index","_createBlock","_component_el_tag","key","effect","_component_like_editing","opt","likes","_hoisted_31","_hoisted_32","region"],"sourceRoot":"","sources":["F:\\personalSpace\\lx-bishe\\movie_recommendation_system_vue\\src\\views\\personal\\PersonalInfoEditingView.vue"],"sourcesContent":["<template>\r\n  <div class=\"bg\">\r\n    <div class=\"info-edit-master\">\r\n      <router-link to=\"/personal\" class=\"back-to-my-home\">返回我的主页></router-link>\r\n\r\n      <div class=\"edit-top\">\r\n        <avatar-edit :size=\"12\" class=\"avatar\"></avatar-edit>\r\n        <div class=\"username-div\">{{ user.username }}</div>\r\n      </div>\r\n\r\n      <div class=\"edit-bottom\">\r\n        <el-divider/>\r\n\r\n        <div class=\"nickname-div\">\r\n          <div class=\"like\">昵称</div>\r\n          <!-- 昵称展示 -->\r\n          <div v-show=\"!isShowNickname\" class=\"content\">\r\n            <span class=\"each\">{{ user.nickname }}</span>\r\n            <span @click=\"isShowNickname = !isShowNickname\" class=\"edit-btn\">\r\n            <el-icon><edit/></el-icon>修改\r\n          </span>\r\n          </div>\r\n\r\n          <!-- 昵称编辑 -->\r\n          <div v-show=\"isShowNickname\" class=\"editing\">\r\n            <el-input\r\n                maxlength=\"10\"\r\n                placeholder=\"请输入更新后的昵称\"\r\n                show-word-limit\r\n                v-model=\"newNickname\" clearable\r\n                class=\"editing-input\">\r\n            </el-input>\r\n            <el-button @click=\"handleUpdateNickname\" type=\"primary\" class=\"editing-btn\">保存</el-button>\r\n            <el-button @click=\"isShowNickname = !isShowNickname\" class=\"editing-btn\">取消</el-button>\r\n          </div>\r\n        </div>\r\n\r\n        <el-divider/>\r\n\r\n        <div class=\"sex\">\r\n          <div class=\"like\">性别</div>\r\n          <!-- 性别展示 -->\r\n          <div v-show=\"!isShowSex\" class=\"content\">\r\n            <span class=\"each\">\r\n              <span v-if=\"user.sex === '男'\">男</span>\r\n              <span v-else-if=\"user.sex === '女'\">女</span>\r\n              <span v-else>保密</span>\r\n            </span>\r\n            <span @click=\"isShowSex = !isShowSex\" class=\"edit-btn\">\r\n              <el-icon><edit/></el-icon>修改\r\n            </span>\r\n          </div>\r\n          <!-- 性别编辑 -->\r\n          <div v-show=\"isShowSex\" class=\"editing\">\r\n            <el-radio-group class=\"editing-input\" v-model=\"newSex\">\r\n              <el-radio label=\"男\">男</el-radio>\r\n              <el-radio label=\"女\">女</el-radio>\r\n              <el-radio label=\"保密\">保密</el-radio>\r\n            </el-radio-group>\r\n            <div>\r\n              <el-button @click=\"handleUpdateSex\" type=\"primary\" class=\"editing-btn\">保存</el-button>\r\n              <el-button @click=\"isShowSex = !isShowSex\" class=\"editing-btn\">取消</el-button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <el-divider/>\r\n\r\n        <div class=\"types\">\r\n          <div class=\"like\">类型喜好</div>\r\n          <el-tag\r\n              v-for=\"(type, index) in types\"\r\n              :key=\"index\"\r\n              class=\"each\"\r\n              type=\"info\"\r\n              effect=\"dark\"\r\n          >\r\n            {{ type }}\r\n          </el-tag>\r\n\r\n          <like-editing :opt=\"1\"\r\n                        :likes=\"types\"/>\r\n        </div>\r\n\r\n        <el-divider/>\r\n\r\n        <div class=\"regions\">\r\n          <div class=\"like\">地区喜好</div>\r\n          <el-tag\r\n              v-for=\"(region, index) in regions\"\r\n              :key=\"index\"\r\n              class=\"each\"\r\n              type=\"info\"\r\n              effect=\"dark\"\r\n          >\r\n            {{ region }}\r\n          </el-tag>\r\n\r\n          <like-editing :opt=\"2\"\r\n                        :likes=\"regions\"/>\r\n        </div>\r\n\r\n        <el-divider/>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport AvatarEdit from \"@/components/personal/edit/AvatarEditing\";\r\nimport {onBeforeUnmount, reactive, ref} from \"vue\";\r\nimport {Edit} from \"@element-plus/icons\";\r\nimport userRequest from \"@/api/user\";\r\nimport {ErrorMessage, SuccessMessage, WarningMessage} from \"@/utils/my-message\";\r\nimport emitter from \"@/utils/event-bus\";\r\nimport LikeEditing from \"@/components/personal/edit/LikeEditing\";\r\n\r\nexport default {\r\n  name: \"PersonalInfoEditView\",\r\n  components: {LikeEditing, Edit, AvatarEdit},\r\n  setup() {\r\n    let user = reactive({\r\n      username: '',\r\n      nickname: '',\r\n      avatar: '',\r\n      sex: '2',\r\n    })\r\n\r\n    // 昵称部分\r\n    let isShowNickname = ref(false)\r\n    let newNickname = ref('')\r\n    let handleUpdateNickname = () => {\r\n      if (newNickname.value.length === 0) {\r\n        WarningMessage(\"昵称不能为空(ˉ﹃ˉ)\")\r\n      } else {\r\n        userRequest.updateUserNickname(newNickname.value).then(res => {\r\n          if (res.code === 200) {\r\n            SuccessMessage(res.msg);\r\n            user.nickname = newNickname.value\r\n            isShowNickname.value = false;\r\n\r\n            emitter.emit('handleHeaderNicknameChange', {\r\n              nickname: newNickname.value\r\n            })\r\n          } else {\r\n            ErrorMessage(res.msg);\r\n          }\r\n        }).catch(err => {\r\n          console.error(err)\r\n        })\r\n      }\r\n    }\r\n\r\n    // 性别部分\r\n    let isShowSex = ref(false)\r\n    let newSex = ref(\"\")\r\n    let handleUpdateSex = () => {\r\n      userRequest.updateUserSex(newSex.value).then(res => {\r\n        if (res.code === 200) {\r\n          SuccessMessage(res.msg);\r\n          user.sex = newSex.value\r\n          isShowSex.value = false;\r\n        } else {\r\n          ErrorMessage(res.msg);\r\n        }\r\n      }).catch(err => {\r\n        console.error(err)\r\n      })\r\n    }\r\n\r\n    // 类型部分\r\n    let types = ref([])\r\n    // 地区部分\r\n    let regions = ref([])\r\n\r\n    /**\r\n     * 初始化界面，数据请求\r\n     */\r\n    userRequest.getUserInfo().then(res => {\r\n      if (res.code === 200) {\r\n        let userInfo = res.data\r\n        user.username = userInfo.username\r\n        user.nickname = userInfo.nickname\r\n        user.avatar = userInfo.avatar\r\n        user.sex = userInfo.sex\r\n        newSex.value = userInfo.sex\r\n\r\n        // 全局事件总线——触发：从服务器获取到个人信息后，将头像路径传递给Avatar.vue\r\n        emitter.emit('handleEditAvatarChange', {\r\n          avatar: user.avatar\r\n        })\r\n      } else {\r\n        ErrorMessage(res.msg)\r\n      }\r\n    }).catch(err => {\r\n      console.error(err)\r\n    })\r\n\r\n    const getTypesAndRegions = () => {\r\n      userRequest.getTypesAndRegions().then(res => {\r\n        if (res.code === 200) {\r\n          types.value = res.data.types\r\n          regions.value = res.data.regions\r\n        }\r\n      }).catch(err => {\r\n        console.error(err)\r\n      })\r\n    }\r\n    // 初始化时，获取用户的电影类型和地区喜好\r\n    getTypesAndRegions()\r\n\r\n    emitter.on('handleLikeEditingUpdate', data => {\r\n      // 用户触发喜好更新时，重新获取更新后的电影类型和地区喜好\r\n      setTimeout(() => {\r\n        getTypesAndRegions()\r\n      }, 200)\r\n    })\r\n\r\n    onBeforeUnmount(() => {\r\n      emitter.off('handleLikeEditingUpdate')\r\n    })\r\n\r\n    return {\r\n      user,\r\n      types,\r\n      regions,\r\n      isShowNickname,\r\n      newNickname,\r\n      handleUpdateNickname,\r\n      isShowSex,\r\n      newSex,\r\n      handleUpdateSex,\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n.bg {\r\n  min-height: 89.6vh;\r\n  padding-left: 20%;\r\n  padding-right: 20%;\r\n  background-color: #d6dbe7;\r\n}\r\n\r\n.info-edit-master {\r\n  min-height: 89.5vh;\r\n  border-style: solid;\r\n  border-width: 1px;\r\n  padding: 0 1rem;\r\n  border-color: #dcdbdb;\r\n  background-color: white;\r\n\r\n  .back-to-my-home {\r\n    position: absolute;\r\n    right: 23%;\r\n    padding-top: 1rem;\r\n    color: rgb(133, 144, 166);\r\n    text-decoration: none;\r\n  }\r\n}\r\n\r\n.edit-top {\r\n  display: flex;\r\n  align-items: flex-end;\r\n\r\n  .username-div {\r\n    display: flex;\r\n    color: rgb(18, 18, 18);\r\n    font-size: 2.5rem;\r\n    font-weight: bold;\r\n    padding-left: 1rem;\r\n  }\r\n}\r\n\r\n.edit-bottom {\r\n  .content {\r\n    display: flex;\r\n  }\r\n\r\n  .sex, .types, .regions, .nickname-div {\r\n    display: flex;\r\n    flex-wrap: wrap;\r\n  }\r\n\r\n  .each {\r\n    margin-left: 1rem;\r\n  }\r\n\r\n  .like {\r\n    font-weight: 600;\r\n    color: rgb(68, 68, 68);\r\n    font-size: 1.1rem;\r\n    width: 6rem;\r\n  }\r\n}\r\n\r\n.edit-btn {\r\n  margin-left: 1rem;\r\n  display: flex;\r\n  align-items: center;\r\n  color: rgb(23, 81, 153);\r\n  white-space: nowrap;\r\n  cursor: pointer; // 鼠标放上去显示手势\r\n}\r\n\r\n// 编辑状态样式\r\n.editing {\r\n  padding-left: 0.5rem;\r\n  max-width: 18rem;\r\n\r\n  .editing-input {\r\n    margin-left: 1rem;\r\n    margin-bottom: 1rem;\r\n  }\r\n\r\n  .editing-btn {\r\n    margin-left: 1rem;\r\n  }\r\n}\r\n\r\n@media screen and (max-width: 800px) {\r\n  .bg {\r\n    padding: 0 0;\r\n  }\r\n\r\n  .back-to-my-home {\r\n    position: relative;\r\n    left: 77%;\r\n    white-space: nowrap;\r\n    padding-top: 1rem;\r\n    color: rgb(133, 144, 166);\r\n    text-decoration: none;\r\n  }\r\n}\r\n\r\n</style>"]},"metadata":{},"sourceType":"module"}