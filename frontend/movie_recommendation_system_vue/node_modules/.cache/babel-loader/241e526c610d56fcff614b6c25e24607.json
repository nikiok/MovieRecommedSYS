{"ast":null,"code":"import { createElementVNode as _createElementVNode, resolveComponent as _resolveComponent, withCtx as _withCtx, createVNode as _createVNode, createTextVNode as _createTextVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, toDisplayString as _toDisplayString, Fragment as _Fragment, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\";\nimport _imports_0 from '../assets/logo.png';\nconst _withScopeId = n => (_pushScopeId(\"data-v-4836ca28\"), n = n(), _popScopeId(), n);\nconst _hoisted_1 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"div\", {\n  class: \"bg\"\n}, null, -1 /* HOISTED */));\nconst _hoisted_2 = {\n  class: \"login-form my-border\"\n};\nconst _hoisted_3 = {\n  class: \"login-form-header\"\n};\nconst _hoisted_4 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"img\", {\n  style: {\n    \"width\": \"75px\",\n    \"height\": \"75px\",\n    \"float\": \"left\",\n    \"padding-right\": \"40px\"\n  },\n  src: _imports_0,\n  alt: \"logo\"\n}, null, -1 /* HOISTED */));\nconst _hoisted_5 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"div\", {\n  class: \"login-form-text\"\n}, \"电影推荐系统 - 忘记密码\", -1 /* HOISTED */));\nconst _hoisted_6 = {\n  key: 0\n};\nconst _hoisted_7 = {\n  class: \"space btn\"\n};\nconst _hoisted_8 = /*#__PURE__*/_createTextVNode(\"确 定\");\nconst _hoisted_9 = {\n  key: 1\n};\nconst _hoisted_10 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"p\", {\n  style: {\n    \"width\": \"100%\",\n    \"text-align\": \"center\",\n    \"color\": \"red\"\n  }\n}, \"邮箱格式有误！\", -1 /* HOISTED */));\nconst _hoisted_11 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"br\", null, null, -1 /* HOISTED */));\nconst _hoisted_12 = {\n  class: \"space btn\"\n};\nconst _hoisted_13 = /*#__PURE__*/_createTextVNode(\"上一步\");\nconst _hoisted_14 = /*#__PURE__*/_createTextVNode(\"确 定\");\nconst _hoisted_15 = {\n  key: 2\n};\nconst _hoisted_16 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"h3\", null, \"找回的密码：\", -1 /* HOISTED */));\nconst _hoisted_17 = {\n  style: {\n    \"width\": \"100%\",\n    \"text-align\": \"center\"\n  }\n};\nconst _hoisted_18 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"p\", {\n  style: {\n    \"color\": \"red\"\n  }\n}, \"注意：请记住找回的密码，并在登录后尽快修改！\", -1 /* HOISTED */));\nconst _hoisted_19 = {\n  style: {\n    \"text-align\": \"center\"\n  }\n};\nconst _hoisted_20 = /*#__PURE__*/_createTextVNode(\"已记住密码，现在去登录\");\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_router_link = _resolveComponent(\"router-link\");\n  const _component_el_step = _resolveComponent(\"el-step\");\n  const _component_el_steps = _resolveComponent(\"el-steps\");\n  const _component_el_input = _resolveComponent(\"el-input\");\n  const _component_el_button = _resolveComponent(\"el-button\");\n  const _component_el_popover = _resolveComponent(\"el-popover\");\n  const _component_el_link = _resolveComponent(\"el-link\");\n  return _openBlock(), _createElementBlock(_Fragment, null, [_hoisted_1, _createElementVNode(\"div\", _hoisted_2, [_createElementVNode(\"div\", _hoisted_3, [_createVNode(_component_router_link, {\n    to: \"/home\"\n  }, {\n    default: _withCtx(() => [_hoisted_4]),\n    _: 1 /* STABLE */\n  }), _hoisted_5]), _createElementVNode(\"div\", null, [_createVNode(_component_el_steps, {\n    active: $setup.active,\n    \"finish-status\": \"success\"\n  }, {\n    default: _withCtx(() => [_createVNode(_component_el_step, {\n      title: \"账 号\"\n    }), _createVNode(_component_el_step, {\n      title: \"邮箱验证\"\n    }), _createVNode(_component_el_step, {\n      title: \"完成\"\n    })]),\n    _: 1 /* STABLE */\n  }, 8 /* PROPS */, [\"active\"])]), $setup.active === 0 ? (_openBlock(), _createElementBlock(\"div\", _hoisted_6, [_createVNode(_component_el_input, {\n    modelValue: $setup.username,\n    \"onUpdate:modelValue\": _cache[0] || (_cache[0] = $event => $setup.username = $event),\n    placeholder: \"要找回的账号\",\n    class: \"space\"\n  }, null, 8 /* PROPS */, [\"modelValue\"]), _createElementVNode(\"div\", _hoisted_7, [_createVNode(_component_el_button, {\n    onClick: $setup.checkUsernameExists,\n    type: \"primary\"\n  }, {\n    default: _withCtx(() => [_hoisted_8]),\n    _: 1 /* STABLE */\n  }, 8 /* PROPS */, [\"onClick\"])])])) : $setup.active === 1 ? (_openBlock(), _createElementBlock(\"div\", _hoisted_9, [_createVNode(_component_el_input, {\n    modelValue: $setup.mail,\n    \"onUpdate:modelValue\": _cache[1] || (_cache[1] = $event => $setup.mail = $event),\n    placeholder: \"请输入该账号对应的邮箱\",\n    class: \"space\"\n  }, {\n    append: _withCtx(() => [_createVNode(_component_el_popover, {\n      visible: $setup.isInputError,\n      placement: \"top\",\n      \"hide-after\": \"1000\"\n    }, {\n      reference: _withCtx(() => [_createVNode(_component_el_button, {\n        disabled: $setup.isDisabled,\n        onClick: $setup.sendAuthCode\n      }, {\n        default: _withCtx(() => [_createTextVNode(_toDisplayString($setup.sendCodeBtnName), 1 /* TEXT */)]),\n\n        _: 1 /* STABLE */\n      }, 8 /* PROPS */, [\"disabled\", \"onClick\"])]),\n      default: _withCtx(() => [_hoisted_10]),\n      _: 1 /* STABLE */\n    }, 8 /* PROPS */, [\"visible\"])]),\n    _: 1 /* STABLE */\n  }, 8 /* PROPS */, [\"modelValue\"]), _hoisted_11, _createVNode(_component_el_input, {\n    modelValue: $setup.authCode,\n    \"onUpdate:modelValue\": _cache[2] || (_cache[2] = $event => $setup.authCode = $event),\n    placeholder: \"验证码\",\n    class: \"space input\"\n  }, null, 8 /* PROPS */, [\"modelValue\"]), _createElementVNode(\"div\", _hoisted_12, [_createVNode(_component_el_button, {\n    onClick: _cache[3] || (_cache[3] = $event => $setup.active--)\n  }, {\n    default: _withCtx(() => [_hoisted_13]),\n    _: 1 /* STABLE */\n  }), _createVNode(_component_el_button, {\n    onClick: $setup.checkAuthCode,\n    type: \"primary\"\n  }, {\n    default: _withCtx(() => [_hoisted_14]),\n    _: 1 /* STABLE */\n  }, 8 /* PROPS */, [\"onClick\"])])])) : $setup.active === 2 ? (_openBlock(), _createElementBlock(\"div\", _hoisted_15, [_hoisted_16, _createElementVNode(\"p\", _hoisted_17, _toDisplayString($setup.newPassword), 1 /* TEXT */), _hoisted_18, _createElementVNode(\"p\", _hoisted_19, [_createVNode(_component_el_link, {\n    type: \"info\",\n    href: \"/login\"\n  }, {\n    default: _withCtx(() => [_hoisted_20]),\n    _: 1 /* STABLE */\n  })])])) : _createCommentVNode(\"v-if\", true)])], 64 /* STABLE_FRAGMENT */);\n}","map":{"version":3,"mappings":";OAOkFA,UAAwB;;gEANxGC,oBAAsB;EAAjBC,KAAK,EAAC;AAAI;;EAEXA,KAAK,EAAC;AAAsB;;EAEzBA,KAAK,EAAC;AAAmB;gEAE1BD,oBAA+G;EAA1GE,KAAoE,EAApE;IAAA;IAAA;IAAA;IAAA;EAAA,CAAoE;EAACC,GAAwB,EAAxBJ,UAAwB;EAACK,GAAG,EAAC;;gEAGzGJ,oBAAgD;EAA3CC,KAAK,EAAC;AAAiB,GAAC,eAAa;;;;;EAarCA,KAAK,EAAC;AAAW;iDACmC,KAAG;;;;iEAOtDD,oBAAmE;EAAhEE,KAAoD,EAApD;IAAA;IAAA;IAAA;EAAA;AAAoD,GAAC,SAAO;iEAOrEF,oBAAK;;EAEAC,KAAK,EAAC;AAAW;kDACU,KAAG;kDACgB,KAAG;;;;iEAItDD,oBAAe,YAAX,QAAM;;EACPE,KAAwC,EAAxC;IAAA;IAAA;EAAA;AAAwC;iEAC3CF,oBAAgD;EAA7CE,KAAkB,EAAlB;IAAA;EAAA;AAAkB,GAAC,wBAAsB;;EACzCA,KAA2B,EAA3B;IAAA;EAAA;AAA2B;kDACO,aAAW;;;;;;;;;6DAjDpDG,UAAsB,EACtBL,oBAmDM,OAnDNM,UAmDM,GAhDJN,oBAMM,OANNO,UAMM,GALJC,aAEcC;IAFDC,EAAE,EAAC;EAAO;sBACrB,MAA+G,CAA/GC,UAA+G;;MAGjHC,UAAgD,IAGlDZ,oBAMM,cALJQ,aAIWK;IAJAC,MAAM,EAAEC,aAAM;IAAE,eAAa,EAAC;;sBACvC,MAAsB,CAAtBP,aAAsBQ;MAAbC,KAAK,EAAC;IAAK,IACpBT,aAAuBQ;MAAdC,KAAK,EAAC;IAAM,IACrBT,aAAqBQ;MAAZC,KAAK,EAAC;IAAI;;mCAIZF,aAAM,wBAAjBG,oBAKM,oBAJJV,aAA2EW;gBAAxDJ,eAAQ;+DAARA,eAAQ;IAAEK,WAAW,EAAC,QAAQ;IAACnB,KAAK,EAAC;2CACxDD,oBAEM,OAFNqB,UAEM,GADJb,aAAsEc;IAA1DC,OAAK,EAAER,0BAAmB;IAAES,IAAI,EAAC;;sBAAU,MAAG;;wCAG9CT,aAAM,wBAAtBG,oBAiBM,oBAhBJV,aASWW;gBATQJ,WAAI;+DAAJA,WAAI;IAAEK,WAAW,EAAC,aAAa;IAACnB,KAAK,EAAC;;IAC5CwB,MAAM,WACf,MAKa,CALbjB,aAKakB;MALAC,OAAO,EAAEZ,mBAAY;MAAEa,SAAS,EAAC,KAAK;MAAC,YAAU,EAAC;;MAElDC,SAAS,WAClB,MAAyF,CAAzFrB,aAAyFc;QAA7EQ,QAAQ,EAAEf,iBAAU;QAAGQ,OAAK,EAAER;;0BAAc,MAAqB,mCAAlBA,sBAAe;;;;wBAF5E,MAAmE,CAAnEgB,WAAmE;;;;qCAOzEC,WAAK,EACLxB,aAA8EW;gBAA3DJ,eAAQ;+DAARA,eAAQ;IAAEK,WAAW,EAAC,KAAK;IAACnB,KAAK,EAAC;2CACrDD,oBAGM,OAHNiC,WAGM,GAFJzB,aAA6Cc;IAAjCC,OAAK,sCAAER,aAAM;;sBAAK,MAAG;;MACjCP,aAAgEc;IAApDC,OAAK,EAAER,oBAAa;IAAES,IAAI,EAAC;;sBAAU,MAAG;;wCAGxCT,aAAM,wBAAtBG,oBAOM,qBANJgB,WAAe,EACflC,oBAAiE,KAAjEmC,WAAiE,mBAAlBpB,kBAAW,kBAC1DqB,WAAgD,EAChDpC,oBAEI,KAFJqC,WAEI,GADF7B,aAAwD8B;IAA/Cd,IAAI,EAAC,MAAM;IAACe,IAAI,EAAC;;sBAAS,MAAW","names":["_imports_0","_createElementVNode","class","style","src","alt","_hoisted_1","_hoisted_2","_hoisted_3","_createVNode","_component_router_link","to","_hoisted_4","_hoisted_5","_component_el_steps","active","$setup","_component_el_step","title","_createElementBlock","_component_el_input","placeholder","_hoisted_7","_component_el_button","onClick","type","append","_component_el_popover","visible","placement","reference","disabled","_hoisted_10","_hoisted_11","_hoisted_12","_hoisted_16","_hoisted_17","_hoisted_18","_hoisted_19","_component_el_link","href"],"sourceRoot":"","sources":["F:\\personalSpace\\lx-bishe\\movie_recommendation_system_vue\\src\\views\\ForgetView.vue"],"sourcesContent":["<template>\r\n  <div class=\"bg\"></div>\r\n  <div\r\n      class=\"login-form my-border\">\r\n\r\n    <div class=\"login-form-header\">\r\n      <router-link to=\"/home\">\r\n        <img style=\"width: 75px; height: 75px; float: left; padding-right: 40px;\" src=\"../assets/logo.png\" alt=\"logo\"/>\r\n      </router-link>\r\n\r\n      <div class=\"login-form-text\">电影推荐系统 - 忘记密码</div>\r\n    </div>\r\n\r\n    <div>\r\n      <el-steps :active=\"active\" finish-status=\"success\">\r\n        <el-step title=\"账 号\"/>\r\n        <el-step title=\"邮箱验证\"/>\r\n        <el-step title=\"完成\"/>\r\n      </el-steps>\r\n    </div>\r\n\r\n    <div v-if=\"active === 0\">\r\n      <el-input v-model=\"username\" placeholder=\"要找回的账号\" class=\"space\"></el-input>\r\n      <div class=\"space btn\">\r\n        <el-button @click=\"checkUsernameExists\" type=\"primary\">确 定</el-button>\r\n      </div>\r\n    </div>\r\n    <div v-else-if=\"active === 1\">\r\n      <el-input v-model=\"mail\" placeholder=\"请输入该账号对应的邮箱\" class=\"space\">\r\n        <template #append>\r\n          <el-popover :visible=\"isInputError\" placement=\"top\" hide-after=\"1000\">\r\n            <p style=\"width: 100%; text-align: center; color: red;\">邮箱格式有误！</p>\r\n            <template #reference>\r\n              <el-button :disabled=\"isDisabled\" @click=\"sendAuthCode\">{{ sendCodeBtnName }}</el-button>\r\n            </template>\r\n          </el-popover>\r\n        </template>\r\n      </el-input>\r\n      <br/>\r\n      <el-input v-model=\"authCode\" placeholder=\"验证码\" class=\"space input\"></el-input>\r\n      <div class=\"space btn\">\r\n        <el-button @click=\"active --\">上一步</el-button>\r\n        <el-button @click=\"checkAuthCode\" type=\"primary\">确 定</el-button>\r\n      </div>\r\n    </div>\r\n    <div v-else-if=\"active === 2\">\r\n      <h3>找回的密码：</h3>\r\n      <p style=\"width: 100%; text-align: center;\">{{ newPassword }}</p>\r\n      <p style=\"color: red\">注意：请记住找回的密码，并在登录后尽快修改！</p>\r\n      <p style=\"text-align: center;\">\r\n        <el-link type=\"info\" href=\"/login\">已记住密码，现在去登录</el-link>\r\n      </p>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport {ref} from \"vue\";\r\nimport authRequest from \"@/api/authentication\";\r\nimport {ErrorMessage, SuccessMessage} from \"@/utils/my-message\";\r\nimport {debounce} from \"@/utils/debounce-throttle\";\r\n\r\nexport default {\r\n  name: 'ForgetView',\r\n  components: {},\r\n  setup() {\r\n    let active = ref(0);\r\n    let username = ref('');\r\n    let newPassword = ref('');\r\n\r\n    // 邮箱\r\n    let mail = ref(\"\");\r\n    // 验证码\r\n    let authCode = ref(\"\");\r\n    // 是否可以点击“发送验证码”按钮，false表示可以\r\n    let isDisabled = ref(false);\r\n    // “发送验证码”按钮中的信息\r\n    let sendCodeBtnName = ref('发送验证码');\r\n    // 邮箱输入是否有误\r\n    let isInputError = ref(false)\r\n    const sendAuthCode = debounce(() => {\r\n      mail.value = mail.value.trim()\r\n      const regex = /^\\w+((-\\w+)|(\\.\\w+))*\\@[A-Za-z0-9]+((\\.|-)[A-Za-z0-9]+)*\\.[A-Za-z0-9]+$/;\r\n      if (!regex.test(mail.value)) {\r\n        console.log(\"邮箱格式有误\");\r\n        isInputError.value = true;\r\n        const showErr = setInterval(() => {\r\n          isInputError.value = false;\r\n          clearInterval(showErr)\r\n        }, 1000);\r\n        return;\r\n      }\r\n\r\n      authRequest.getAuthCodeUnderLogout(username.value, mail.value).then(res => {\r\n        if (res.code === 200) {\r\n          SuccessMessage(res.msg);\r\n          // 60秒内不能再次发送验证码\r\n          sendCodeBtnName.value = \"60秒后可重发\";\r\n          let time = 60;\r\n          isDisabled.value = true;\r\n          const interval = setInterval(() => {\r\n            time--;\r\n            sendCodeBtnName.value = time + \"秒后可重发\";\r\n            // 60秒时间到后，将定时器清除，用户可以重新发送验证码\r\n            if (time === 0) {\r\n              clearInterval(interval)\r\n              sendCodeBtnName.value = '发送验证码';\r\n              isDisabled.value = false;\r\n            }\r\n          }, 1000);\r\n        } else {\r\n          ErrorMessage(res.msg)\r\n        }\r\n      }).catch(err => {\r\n        console.error(err)\r\n      })\r\n    })\r\n\r\n    const checkUsernameExists = debounce(() => {\r\n      username.value = username.value.trim();\r\n      authRequest.checkUsernameExists(username.value).then(res => {\r\n        if (res.code === 200) {\r\n          SuccessMessage(res.msg)\r\n          active.value++;\r\n        } else {\r\n          ErrorMessage(res.msg)\r\n        }\r\n      })\r\n    })\r\n\r\n    const checkAuthCode = debounce(() => {\r\n      username.value = username.value.trim()\r\n      authCode.value = authCode.value.trim();\r\n      authRequest.checkAuthCode(username.value, authCode.value).then(res => {\r\n        if (res.code === 200) {\r\n          SuccessMessage(res.msg);\r\n\r\n          authRequest.judgeAndFindPassword(username.value, authCode.value).then(res => {\r\n            if (res.code === 200) {\r\n              newPassword.value = res.data.password\r\n              active.value++;\r\n            }\r\n          })\r\n        } else {\r\n          ErrorMessage(res.msg)\r\n        }\r\n      }).catch(err => {\r\n        console.error(err)\r\n      })\r\n    })\r\n\r\n    return {\r\n      active,\r\n      username,\r\n      newPassword,\r\n      mail,\r\n      authCode,\r\n      isDisabled,\r\n      sendCodeBtnName,\r\n      isInputError,\r\n      sendAuthCode,\r\n      checkUsernameExists,\r\n      checkAuthCode,\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n.space {\r\n  margin: 0.5rem 0;\r\n}\r\n\r\n.btn {\r\n  display: flex;\r\n  justify-content: right;\r\n}\r\n\r\n.bg {\r\n  height: 100%;\r\n  width: 100%;\r\n  position: absolute;\r\n  background-size: cover;\r\n}\r\n\r\n.login-form {\r\n  width: 28rem;\r\n  position: absolute;\r\n  left: 50%;\r\n  top: 10rem;\r\n  transform: translate(-50%, 0);\r\n  padding: 2rem;\r\n  margin-top: 1rem;\r\n  letter-spacing: 2px;\r\n}\r\n\r\n.login-form-header {\r\n  height: 20px;\r\n  padding-left: 45px;\r\n  padding-bottom: 100px;\r\n}\r\n\r\n.login-form-text {\r\n  color: #000000;\r\n  font-weight: bold;\r\n  font-size: 1.4rem;\r\n  padding-top: 15px;\r\n}\r\n\r\n.login-form-input {\r\n  margin-bottom: 10px;\r\n}\r\n\r\n.login-form-button {\r\n  border-radius: 3px;\r\n  width: 100%;\r\n  font-weight: 600;\r\n  font-size: 15px;\r\n  letter-spacing: 2px;\r\n  height: 3.5rem;\r\n  background: #5a84fd;\r\n  margin-top: 35px;\r\n}\r\n\r\n.login-form-button:hover {\r\n  box-shadow: 0 10px 30px #2156f6;\r\n  transition: 3s;\r\n}\r\n\r\n.scan-and-forget-div {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  margin-top: 10px;\r\n}\r\n\r\n.my-font {\r\n  font-weight: bolder;\r\n  font-size: 14px;\r\n  color: #91949c;\r\n}\r\n\r\n.my-font:hover {\r\n  color: #5a84fd;\r\n}\r\n\r\n.login-form-footer {\r\n  font-weight: bolder;\r\n  color: #91949c;\r\n  padding-top: 1.5rem;\r\n  text-align: center;\r\n}\r\n\r\n/deep/ .el-input__inner {\r\n  height: 3rem;\r\n}\r\n\r\n.el-checkbox {\r\n  color: #91949c;\r\n  font-weight: bolder;\r\n  font-size: 15px;\r\n}\r\n\r\n/deep/ .el-form-item__label {\r\n  color: #91949c;\r\n  font-weight: bold;\r\n}\r\n\r\n/deep/ .el-form-item {\r\n  align-items: baseline;\r\n}\r\n\r\n.bg-change {\r\n  background-color: #e74c3c;\r\n  animation: bg-color 20s infinite;\r\n  -webkit-animation: bg-color 20s infinite;\r\n}\r\n\r\n@-webkit-keyframes bg-color {\r\n  0% {\r\n    background-color: #f18f87;\r\n  }\r\n  20% {\r\n    background-color: #ead18c;\r\n  }\r\n  40% {\r\n    background-color: #8be1d1;\r\n  }\r\n  60% {\r\n    background-color: #8cbee1;\r\n  }\r\n  80% {\r\n    background-color: #cba2e1;\r\n  }\r\n  100% {\r\n    background-color: #f18f87;\r\n  }\r\n}\r\n\r\n@keyframes bg-color {\r\n  0% {\r\n    background-color: #f18f87;\r\n  }\r\n  20% {\r\n    background-color: #ead18c;\r\n  }\r\n  40% {\r\n    background-color: #8be1d1;\r\n  }\r\n  60% {\r\n    background-color: #8cbee1;\r\n  }\r\n  80% {\r\n    background-color: #cba2e1;\r\n  }\r\n  100% {\r\n    background-color: #f18f87;\r\n  }\r\n}\r\n</style>\r\n"]},"metadata":{},"sourceType":"module"}