{"ast":null,"code":"import MovieStrip from \"@/components/basic/MovieStrip\";\nimport { ref, watch } from \"vue\";\nimport movieRequest from \"@/api/movie\";\nimport BlankPage from \"@/components/basic/BlankPage\";\nexport default {\n  name: \"WatchedMoviesView\",\n  components: {\n    BlankPage,\n    MovieStrip\n  },\n  setup() {\n    let loading = ref(true);\n    let reviewedMovies = ref([]);\n\n    // 分页查询需要用到的一些数据\n    let currentPage = ref(1); // 当前页码\n    let pageSize = ref(10); // 每页电影数量\n    let total = ref(0); // 总电影数\n\n    const getMoreReviewedMovies = () => {\n      reviewedMovies.value = [];\n      loading.value = true;\n      movieRequest.getMoreReviewedMovies(currentPage.value, pageSize.value).then(res => {\n        if (res.code === 200) {\n          reviewedMovies.value = res.data.records;\n          for (let i = 0; i < reviewedMovies.value.length; ++i) {\n            reviewedMovies.value[i].userScore /= 2;\n          }\n          loading.value = false;\n          total.value = res.data.total;\n        }\n      }).catch(err => {\n        console.error(err);\n      });\n    };\n    getMoreReviewedMovies();\n\n    /**\r\n     * 监听`当前页码`变化\r\n     * 若页码发生变化，重新请求电影数据，随后页面发生变化。\r\n     */\n    watch(currentPage, (newValue, oldValue) => {\n      // 页面回到顶部\n      document.body.scrollTop = 0;\n      document.documentElement.scrollTop = 0;\n      // 兼容IE\n      window.scrollTo(0, 0);\n      getMoreReviewedMovies();\n    });\n    return {\n      currentPage,\n      pageSize,\n      total,\n      loading,\n      reviewedMovies\n    };\n  }\n};","map":{"version":3,"mappings":"AAyDA,OAAOA,UAAS,MAAO,+BAA+B;AACtD,SAAQC,GAAG,EAAEC,KAAK,QAAO,KAAK;AAC9B,OAAOC,YAAW,MAAO,aAAa;AACtC,OAAOC,SAAQ,MAAO,8BAA8B;AAEpD,eAAe;EACbC,IAAI,EAAE,mBAAmB;EACzBC,UAAU,EAAE;IAACF,SAAS;IAAEJ;EAAU,CAAC;EACnCO,KAAKA,GAAG;IACN,IAAIC,OAAM,GAAIP,GAAG,CAAC,IAAI;IACtB,IAAIQ,cAAa,GAAIR,GAAG,CAAC,EAAE;;IAE3B;IACA,IAAIS,WAAU,GAAIT,GAAG,CAAC,CAAC,CAAC,EAAE;IAC1B,IAAIU,QAAO,GAAIV,GAAG,CAAC,EAAE,CAAC,EAAI;IAC1B,IAAIW,KAAI,GAAIX,GAAG,CAAC,CAAC,CAAC,EAAO;;IAEzB,MAAMY,qBAAoB,GAAIA,MAAM;MAClCJ,cAAc,CAACK,KAAI,GAAI,EAAE;MACzBN,OAAO,CAACM,KAAI,GAAI,IAAI;MACpBX,YAAY,CAACU,qBAAqB,CAACH,WAAW,CAACI,KAAK,EAAEH,QAAQ,CAACG,KAAK,CAAC,CAACC,IAAI,CAACC,GAAE,IAAK;QAChF,IAAIA,GAAG,CAACC,IAAG,KAAM,GAAG,EAAE;UACpBR,cAAc,CAACK,KAAI,GAAIE,GAAG,CAACE,IAAI,CAACC,OAAM;UACtC,KAAK,IAAIC,IAAI,CAAC,EAAEA,IAAIX,cAAc,CAACK,KAAK,CAACO,MAAM,EAAE,EAAED,CAAC,EAAE;YACpDX,cAAc,CAACK,KAAK,CAACM,CAAC,CAAC,CAACE,SAAQ,IAAK;UACvC;UACAd,OAAO,CAACM,KAAI,GAAI,KAAK;UACrBF,KAAK,CAACE,KAAI,GAAIE,GAAG,CAACE,IAAI,CAACN,KAAK;QAC9B;MACF,CAAC,CAAC,CAACW,KAAK,CAACC,GAAE,IAAK;QACdC,OAAO,CAACC,KAAK,CAACF,GAAG;MACnB,CAAC;IACH;IACAX,qBAAqB,CAAC,CAAC;;IAEvB;;;;IAIAX,KAAK,CAACQ,WAAW,EAAE,CAACiB,QAAQ,EAAEC,QAAQ,KAAK;MACzC;MACAC,QAAQ,CAACC,IAAI,CAACC,SAAQ,GAAI,CAAC;MAC3BF,QAAQ,CAACG,eAAe,CAACD,SAAQ,GAAI,CAAC;MACtC;MACAE,MAAM,CAACC,QAAQ,CAAC,CAAC,EAAE,CAAC,CAAC;MAErBrB,qBAAqB,CAAC,CAAC;IACzB,CAAC,CAAC;IAEF,OAAO;MACLH,WAAW;MACXC,QAAQ;MACRC,KAAK;MACLJ,OAAO;MACPC;IACF;EACF;AACF","names":["MovieStrip","ref","watch","movieRequest","BlankPage","name","components","setup","loading","reviewedMovies","currentPage","pageSize","total","getMoreReviewedMovies","value","then","res","code","data","records","i","length","userScore","catch","err","console","error","newValue","oldValue","document","body","scrollTop","documentElement","window","scrollTo"],"sourceRoot":"","sources":["F:\\personalSpace\\lx-bishe\\movie_recommendation_system_vue\\src\\views\\personal\\info\\WatchedMoviesView.vue"],"sourcesContent":["<template>\r\n  <el-skeleton :loading=\"loading\" :rows=\"5\" animated/>\r\n\r\n  <template v-for=\"(movie, index) in reviewedMovies\" :key=\"index\">\r\n    <movie-strip :movie=\"movie\" style=\"margin-bottom: 1rem;\">\r\n      <template v-slot:footer>\r\n        <div class=\"movie-strip-slot\">\r\n          <span v-if=\"movie.time\" class=\"time\">\r\n            {{ movie.time }} 看过\r\n          </span>\r\n          <el-divider direction=\"vertical\"/>\r\n          <el-rate\r\n              v-model=\"movie.userScore\"\r\n              disabled\r\n              size=\"small\"\r\n              :texts=\"['很差', '较差', '还行', '推荐', '力荐']\"\r\n              :colors=\"['#777777', '#777777', '#777777']\"\r\n              show-text\r\n              text-color=\"#777777\"\r\n              disabled-void-color=\"rgb(226, 226, 226)\"\r\n          />\r\n        </div>\r\n      </template>\r\n    </movie-strip>\r\n  </template>\r\n\r\n  <blank-page v-if=\"!loading && !reviewedMovies.length\" :page-name=\"'record'\"></blank-page>\r\n\r\n  <!-- 分页 样式1-->\r\n  <div v-if=\"total > 10\" class=\"pagination-style-first\">\r\n    <el-pagination\r\n        style=\"justify-content: center\"\r\n        v-model:currentPage=\"currentPage\"\r\n        v-model:page-size=\"pageSize\"\r\n        v-model:total=\"total\"\r\n        pager-count=\"7\"\r\n        background\r\n        layout=\"total, prev, pager, next, jumper\"\r\n    />\r\n  </div>\r\n\r\n  <!-- 分页 样式2 -->\r\n  <div v-if=\"total > 10\" class=\"pagination-style-second\">\r\n    <el-pagination\r\n        style=\"justify-content: center\"\r\n        v-model:currentPage=\"currentPage\"\r\n        v-model:page-size=\"pageSize\"\r\n        v-model:total=\"total\"\r\n        pager-count=\"5\"\r\n        small\r\n        background\r\n        layout=\"prev, pager, next, jumper\"\r\n    />\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport MovieStrip from \"@/components/basic/MovieStrip\";\r\nimport {ref, watch} from \"vue\";\r\nimport movieRequest from \"@/api/movie\";\r\nimport BlankPage from \"@/components/basic/BlankPage\";\r\n\r\nexport default {\r\n  name: \"WatchedMoviesView\",\r\n  components: {BlankPage, MovieStrip},\r\n  setup() {\r\n    let loading = ref(true)\r\n    let reviewedMovies = ref([])\r\n\r\n    // 分页查询需要用到的一些数据\r\n    let currentPage = ref(1); // 当前页码\r\n    let pageSize = ref(10);   // 每页电影数量\r\n    let total = ref(0);      // 总电影数\r\n\r\n    const getMoreReviewedMovies = () => {\r\n      reviewedMovies.value = [];\r\n      loading.value = true;\r\n      movieRequest.getMoreReviewedMovies(currentPage.value, pageSize.value).then(res => {\r\n        if (res.code === 200) {\r\n          reviewedMovies.value = res.data.records\r\n          for (let i = 0; i < reviewedMovies.value.length; ++i) {\r\n            reviewedMovies.value[i].userScore /= 2\r\n          }\r\n          loading.value = false;\r\n          total.value = res.data.total;\r\n        }\r\n      }).catch(err => {\r\n        console.error(err)\r\n      })\r\n    }\r\n    getMoreReviewedMovies();\r\n\r\n    /**\r\n     * 监听`当前页码`变化\r\n     * 若页码发生变化，重新请求电影数据，随后页面发生变化。\r\n     */\r\n    watch(currentPage, (newValue, oldValue) => {\r\n      // 页面回到顶部\r\n      document.body.scrollTop = 0;\r\n      document.documentElement.scrollTop = 0;\r\n      // 兼容IE\r\n      window.scrollTo(0, 0);\r\n\r\n      getMoreReviewedMovies();\r\n    });\r\n\r\n    return {\r\n      currentPage,\r\n      pageSize,\r\n      total,\r\n      loading,\r\n      reviewedMovies\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n.movie-strip-slot {\r\n  display: flex;\r\n  align-items: center;\r\n  width: 100%;\r\n  background-color: rgb(245, 245, 254);\r\n  padding: 0.3rem 0;\r\n  border-style: solid;\r\n  border-color: #b0d2e5;\r\n  border-radius: 0.5rem;\r\n  border-width: 1px;\r\n\r\n  .time {\r\n    font-size: 0.8rem;\r\n    color: #91949c;\r\n    padding-left: 0.3rem;\r\n  }\r\n}\r\n\r\n/* 分页模块样式 */\r\n.pagination-style-first, .pagination-style-second {\r\n  margin: 1rem 0;\r\n}\r\n\r\n.pagination-style-first {\r\n  display: block;\r\n}\r\n\r\n.pagination-style-second {\r\n  display: none;\r\n}\r\n\r\n@media screen and (max-width: 1000px) {\r\n  .pagination-style-first {\r\n    display: none;\r\n  }\r\n\r\n  .pagination-style-second {\r\n    display: block;\r\n  }\r\n}\r\n</style>"]},"metadata":{},"sourceType":"module"}