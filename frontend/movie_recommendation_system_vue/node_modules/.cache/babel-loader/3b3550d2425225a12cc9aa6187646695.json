{"ast":null,"code":"import { createCommentVNode as _createCommentVNode, resolveComponent as _resolveComponent, createVNode as _createVNode, withCtx as _withCtx, createElementVNode as _createElementVNode, openBlock as _openBlock, createBlock as _createBlock, renderList as _renderList, Fragment as _Fragment, createElementBlock as _createElementBlock, vShow as _vShow, withDirectives as _withDirectives, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\";\nconst _withScopeId = n => (_pushScopeId(\"data-v-aabf83c8\"), n = n(), _popScopeId(), n);\nconst _hoisted_1 = {\n  class: \"movie-cards-master my-border\"\n};\nconst _hoisted_2 = {\n  class: \"card-or-strip-switch\"\n};\nconst _hoisted_3 = {\n  style: {\n    \"padding-top\": \"1rem\",\n    \"padding-bottom\": \"1rem\"\n  }\n};\nconst _hoisted_4 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"br\", null, null, -1 /* HOISTED */));\nconst _hoisted_5 = {\n  class: \"movie-cards\"\n};\nconst _hoisted_6 = {\n  class: \"movie-strips\"\n};\nconst _hoisted_7 = {\n  class: \"pagination-style-first\"\n};\nconst _hoisted_8 = {\n  class: \"pagination-style-second\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_icon_list = _resolveComponent(\"icon-list\");\n  const _component_el_icon = _resolveComponent(\"el-icon\");\n  const _component_el_switch = _resolveComponent(\"el-switch\");\n  const _component_icon_grid = _resolveComponent(\"icon-grid\");\n  const _component_el_skeleton_item = _resolveComponent(\"el-skeleton-item\");\n  const _component_el_skeleton = _resolveComponent(\"el-skeleton\");\n  const _component_blank_page = _resolveComponent(\"blank-page\");\n  const _component_movie_card = _resolveComponent(\"movie-card\");\n  const _component_movie_strip = _resolveComponent(\"movie-strip\");\n  const _component_el_pagination = _resolveComponent(\"el-pagination\");\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createCommentVNode(\" 电影 卡片 or 长条 开关 \"), _createElementVNode(\"div\", _hoisted_2, [_createVNode(_component_el_icon, null, {\n    default: _withCtx(() => [_createVNode(_component_icon_list, {\n      color: $setup.listColor\n    }, null, 8 /* PROPS */, [\"color\"])]),\n    _: 1 /* STABLE */\n  }), _createVNode(_component_el_switch, {\n    modelValue: $setup.isCard,\n    \"onUpdate:modelValue\": _cache[0] || (_cache[0] = $event => $setup.isCard = $event),\n    \"active-color\": \"#13ce66\",\n    \"inactive-color\": \"#36a4ff\",\n    \"active-value\": true,\n    \"inactive-value\": false,\n    onChange: $setup.handleSwitch\n  }, null, 8 /* PROPS */, [\"modelValue\", \"onChange\"]), _createVNode(_component_el_icon, null, {\n    default: _withCtx(() => [_createVNode(_component_icon_grid, {\n      color: $setup.gridColor\n    }, null, 8 /* PROPS */, [\"color\"])]),\n    _: 1 /* STABLE */\n  })]), _createVNode(_component_el_skeleton, {\n    loading: $setup.loading && $setup.isCard,\n    style: {\n      \"width\": \"25rem\",\n      \"margin-left\": \"1rem\"\n    },\n    animated: \"\"\n  }, {\n    template: _withCtx(() => [_createVNode(_component_el_skeleton_item, {\n      variant: \"image\",\n      style: {\n        \"width\": \"13.8rem\",\n        \"height\": \"19.8rem\"\n      }\n    }), _createElementVNode(\"div\", _hoisted_3, [_createVNode(_component_el_skeleton_item, {\n      variant: \"p\",\n      style: {\n        \"width\": \"8rem\",\n        \"text-align\": \"center\"\n      }\n    }), _hoisted_4, _createVNode(_component_el_skeleton_item, {\n      variant: \"p\",\n      style: {\n        \"width\": \"13.8rem\"\n      }\n    })])]),\n    _: 1 /* STABLE */\n  }, 8 /* PROPS */, [\"loading\"]), _createVNode(_component_el_skeleton, {\n    style: {\n      \"width\": \"94%\",\n      \"padding-left\": \"3%\"\n    },\n    loading: $setup.loading && !$setup.isCard,\n    rows: 5,\n    animated: \"\"\n  }, null, 8 /* PROPS */, [\"loading\"]), !$setup.movies.length && !$setup.loading ? (_openBlock(), _createBlock(_component_blank_page, {\n    key: 0,\n    \"page-name\": \"movie\"\n  })) : _createCommentVNode(\"v-if\", true), _createCommentVNode(\" 电影卡片显示 \"), _withDirectives(_createElementVNode(\"div\", _hoisted_5, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList($setup.movies, movie => {\n    return _openBlock(), _createBlock(_component_movie_card, {\n      key: movie.id,\n      class: \"card\",\n      movie: movie\n    }, null, 8 /* PROPS */, [\"movie\"]);\n  }), 128 /* KEYED_FRAGMENT */))], 512 /* NEED_PATCH */), [[_vShow, $setup.isCard]]), _createCommentVNode(\" 电影长条显示 \"), _withDirectives(_createElementVNode(\"div\", _hoisted_6, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList($setup.movies, movie => {\n    return _openBlock(), _createBlock(_component_movie_strip, {\n      key: movie.id,\n      class: \"strip\",\n      movie: movie\n    }, null, 8 /* PROPS */, [\"movie\"]);\n  }), 128 /* KEYED_FRAGMENT */))], 512 /* NEED_PATCH */), [[_vShow, !$setup.isCard]]), _createCommentVNode(\" 分页 样式1\"), _withDirectives(_createElementVNode(\"div\", _hoisted_7, [_createVNode(_component_el_pagination, {\n    style: {\n      \"justify-content\": \"center\"\n    },\n    currentPage: $setup.currentPage,\n    \"onUpdate:currentPage\": _cache[1] || (_cache[1] = $event => $setup.currentPage = $event),\n    \"page-size\": $setup.pageSize,\n    \"onUpdate:page-size\": _cache[2] || (_cache[2] = $event => $setup.pageSize = $event),\n    total: $setup.total,\n    \"onUpdate:total\": _cache[3] || (_cache[3] = $event => $setup.total = $event),\n    \"pager-count\": 7,\n    background: \"\",\n    layout: \"total, prev, pager, next, jumper\"\n  }, null, 8 /* PROPS */, [\"currentPage\", \"page-size\", \"total\"])], 512 /* NEED_PATCH */), [[_vShow, $setup.total > 12]]), _createCommentVNode(\" 分页 样式2 \"), _withDirectives(_createElementVNode(\"div\", _hoisted_8, [_createVNode(_component_el_pagination, {\n    style: {\n      \"justify-content\": \"center\"\n    },\n    currentPage: $setup.currentPage,\n    \"onUpdate:currentPage\": _cache[4] || (_cache[4] = $event => $setup.currentPage = $event),\n    \"page-size\": $setup.pageSize,\n    \"onUpdate:page-size\": _cache[5] || (_cache[5] = $event => $setup.pageSize = $event),\n    total: $setup.total,\n    \"onUpdate:total\": _cache[6] || (_cache[6] = $event => $setup.total = $event),\n    \"pager-count\": 5,\n    small: \"\",\n    background: \"\",\n    layout: \"prev, pager, next, jumper\"\n  }, null, 8 /* PROPS */, [\"currentPage\", \"page-size\", \"total\"])], 512 /* NEED_PATCH */), [[_vShow, $setup.total > 12]])]);\n}","map":{"version":3,"mappings":"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","names":["class","style","_createElementVNode","_createElementBlock","_hoisted_1","_createCommentVNode","_hoisted_2","_createVNode","_component_el_icon","_component_icon_list","color","$setup","_component_el_switch","onChange","_component_icon_grid","_component_el_skeleton","loading","animated","template","_component_el_skeleton_item","variant","_hoisted_3","_hoisted_4","rows","length","_createBlock","_component_blank_page","_hoisted_5","_Fragment","movie","_component_movie_card","id","_hoisted_6","_component_movie_strip","_hoisted_7","_component_el_pagination","currentPage","total","background","layout","_hoisted_8","small"],"sourceRoot":"","sources":["F:\\personalSpace\\lx-bishe\\movie_recommendation_system_vue\\src\\components\\classification\\MovieCards.vue"],"sourcesContent":["<template>\r\n  <div class=\"movie-cards-master my-border\">\r\n    <!-- 电影 卡片 or 长条 开关 -->\r\n    <div class=\"card-or-strip-switch\">\r\n      <el-icon>\r\n        <icon-list :color=\"listColor\"/>\r\n      </el-icon>\r\n\r\n      <el-switch\r\n          v-model=\"isCard\"\r\n          active-color=\"#13ce66\"\r\n          inactive-color=\"#36a4ff\"\r\n          :active-value=\"true\"\r\n          :inactive-value=\"false\"\r\n          @change=\"handleSwitch\"\r\n      />\r\n\r\n      <el-icon>\r\n        <icon-grid :color=\"gridColor\"/>\r\n      </el-icon>\r\n    </div>\r\n\r\n    <el-skeleton :loading=\"loading && isCard\" style=\"width: 25rem; margin-left: 1rem\" animated>\r\n      <template #template>\r\n        <el-skeleton-item variant=\"image\" style=\"width: 13.8rem; height: 19.8rem\" />\r\n        <div style=\"padding-top: 1rem; padding-bottom: 1rem;\">\r\n          <el-skeleton-item variant=\"p\" style=\"width: 8rem; text-align: center\" />\r\n          <br/>\r\n          <el-skeleton-item variant=\"p\" style=\"width: 13.8rem\" />\r\n        </div>\r\n      </template>\r\n    </el-skeleton>\r\n\r\n    <el-skeleton\r\n        style=\"width: 94%; padding-left: 3%\"\r\n        :loading=\"loading && !isCard\"\r\n        :rows=\"5\"\r\n        animated/>\r\n\r\n    <blank-page v-if=\"!movies.length && !loading\" page-name=\"movie\"></blank-page>\r\n\r\n    <!-- 电影卡片显示 -->\r\n    <div v-show=\"isCard\" class=\"movie-cards\">\r\n      <template\r\n          v-for=\"movie in movies\"\r\n          :key=\"movie.id\">\r\n        <movie-card class=\"card\" :movie=\"movie\"></movie-card>\r\n      </template>\r\n    </div>\r\n\r\n    <!-- 电影长条显示 -->\r\n    <div v-show=\"!isCard\" class=\"movie-strips\">\r\n      <template\r\n          v-for=\"movie in movies\"\r\n          :key=\"movie.id\">\r\n        <movie-strip class=\"strip\" :movie=\"movie\"></movie-strip>\r\n\r\n      </template>\r\n    </div>\r\n\r\n    <!-- 分页 样式1-->\r\n    <div v-show=\"total > 12\" class=\"pagination-style-first\">\r\n      <el-pagination\r\n          style=\"justify-content: center\"\r\n          v-model:currentPage=\"currentPage\"\r\n          v-model:page-size=\"pageSize\"\r\n          v-model:total=\"total\"\r\n          :pager-count=\"7\"\r\n          background\r\n          layout=\"total, prev, pager, next, jumper\"\r\n      />\r\n    </div>\r\n\r\n    <!-- 分页 样式2 -->\r\n    <div v-show=\"total > 12\" class=\"pagination-style-second\">\r\n      <el-pagination\r\n          style=\"justify-content: center\"\r\n          v-model:currentPage=\"currentPage\"\r\n          v-model:page-size=\"pageSize\"\r\n          v-model:total=\"total\"\r\n          :pager-count=\"5\"\r\n          small\r\n          background\r\n          layout=\"prev, pager, next, jumper\"\r\n      />\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport {PictureRounded, Menu as IconMenu, Grid as IconGrid, List as IconList} from \"@element-plus/icons-vue\";\r\nimport MovieCard from \"@/components/basic/MovieCard\";\r\nimport {onBeforeUnmount, onMounted, reactive, ref, toRaw, watch} from \"vue\";\r\nimport MovieStrip from \"@/components/basic/MovieStrip\";\r\nimport emitter from \"@/utils/event-bus\";\r\nimport movieRequest from \"@/api/movie\";\r\nimport {ErrorMessage} from \"@/utils/my-message\";\r\nimport {useRouter} from \"vue-router\";\r\nimport BlankPage from \"@/components/basic/BlankPage\";\r\n\r\nexport default {\r\n  // 这里用来纪念一下困扰我多天的低级错误，把MovieCard.vue 和 MovieCards.vue的name都写成了MovieCard，导致递归堆栈溢出问题！！！\r\n  name: \"MovieCards\",\r\n  components: {\r\n    BlankPage,\r\n    IconMenu,\r\n    IconGrid,\r\n    IconList,\r\n    PictureRounded,\r\n    MovieCard,\r\n    MovieStrip\r\n  },\r\n  setup() {\r\n    const router = useRouter()\r\n\r\n    let loading = ref(false);\r\n\r\n    // 分页结果，电影列表\r\n    let movies = ref([]);\r\n\r\n    // 分页查询需要用到的一些数据\r\n    let currentPage = ref(1); // 当前页码\r\n    let pageSize = ref(12);   // 每页电影数量\r\n    let total = ref(movies.value.length); // 总电影数\r\n    let type = ref('全部');    // 电影类型\r\n    let region = ref('全部');  // 电影地区\r\n    let searchWord = ref('');  // 搜索关键字\r\n\r\n    /**\r\n     * 向服务器请求电影数据\r\n     */\r\n    let getMovies = () => {\r\n      loading.value = true;\r\n      movies.value = []\r\n      movieRequest.getMovies(\r\n          currentPage.value,\r\n          pageSize.value,\r\n          type.value,\r\n          region.value,\r\n          searchWord.value\r\n      ).then(res => {\r\n        if (res.code === 200) {\r\n          movies.value = res.data.records;\r\n          total.value = res.data.total;\r\n        }\r\n        loading.value = false;\r\n      }).catch(err => {\r\n        ErrorMessage(err)\r\n      })\r\n    }\r\n\r\n    // 初始化页面时，获取电影信息列表\r\n    let keywords = ref(router.currentRoute.value.query.keywords)\r\n    onMounted(() => {\r\n      if (keywords.value === undefined) {\r\n        getMovies()\r\n      } else {\r\n        searchWord.value = keywords.value\r\n        getMovies()\r\n      }\r\n    })\r\n\r\n\r\n    /**\r\n     * 监听`当前页码`变化\r\n     * 若页码发生变化，重新请求电影数据，随后页面发生变化。\r\n     */\r\n    watch(currentPage, (newValue, oldValue) => {\r\n      // 页面回到顶部（兼容不同浏览器）\r\n      document.body.scrollTop = 0;\r\n      document.documentElement.scrollTop = 0;\r\n      window.scrollTo(0, 0);\r\n\r\n      getMovies()\r\n    });\r\n\r\n    /**\r\n     * 监听`每页电影数量`变化（可扩展）\r\n     * 若发生变化，重新请求电影数据，随后页面发生变化。\r\n     */\r\n    watch(pageSize, (newValue, oldValue) => {\r\n\r\n    })\r\n\r\n    /**\r\n     * 全局事件总线\r\n     * 监听MovieTags.vue中的type和region的变化\r\n     */\r\n    emitter.on('handleTypeOrRegionChange', data => {\r\n      type.value = data.type;\r\n      region.value = data.region;\r\n      currentPage.value = 1;\r\n      getMovies();\r\n    })\r\n\r\n    /**\r\n     * 全局事件总线\r\n     * 监听MovieHeader.vue中的keywords变化\r\n     */\r\n    emitter.on('handleSearch', data => {\r\n      searchWord.value = data.searchKeywords\r\n      getMovies()\r\n    })\r\n\r\n    // 电影 卡片 or 长条 开关值，true为卡片，false为长条\r\n    let isCard = ref(true);\r\n    let listColor = ref('');\r\n    let gridColor = ref('#13ce66');\r\n    let handleSwitch = val => {\r\n      if (!val) {\r\n        listColor.value = '#36a4ff';\r\n        gridColor.value = '';\r\n      } else {\r\n        listColor.value = '';\r\n        gridColor.value = '#13ce66';\r\n      }\r\n    }\r\n\r\n    onBeforeUnmount(() => {\r\n      emitter.off('handleTypeOrRegionChange');\r\n      emitter.off('handleSearch')\r\n    })\r\n\r\n    return {\r\n      loading,\r\n      pageSize,\r\n      currentPage,\r\n      total,\r\n      movies,\r\n      isCard,\r\n      listColor,\r\n      gridColor,\r\n      getMovies,\r\n      handleSwitch,\r\n    }\r\n  },\r\n}\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n.movie-cards-master {\r\n  margin-bottom: 1rem;\r\n}\r\n\r\n/* 卡片or长条开关样式 */\r\n.card-or-strip-switch {\r\n  display: flex;\r\n  justify-content: right;\r\n  align-items: center;\r\n  margin-right: 2rem;\r\n  margin-top: 0.3rem;\r\n}\r\n\r\n/* 电影卡片样式 */\r\n.movie-cards {\r\n  display: grid;\r\n  justify-content: space-evenly;\r\n  grid-template-columns: repeat(auto-fill, 13.8rem);\r\n\r\n  .card {\r\n    margin-top: 0.3rem;\r\n  }\r\n}\r\n\r\n/* 电影长条样式 */\r\n.movie-strips {\r\n  margin-left: 3rem;\r\n  margin-right: 3rem;\r\n\r\n  .strip {\r\n    margin-top: 0.3rem;\r\n    margin-bottom: 1rem;\r\n  }\r\n}\r\n\r\n\r\n/* 分页模块样式 */\r\n.pagination-style-first, .pagination-style-second {\r\n  margin: 1rem 0;\r\n}\r\n\r\n.pagination-style-first {\r\n  display: block;\r\n}\r\n\r\n.pagination-style-second {\r\n  display: none;\r\n}\r\n\r\n@media screen and (max-width: 1000px) {\r\n  .pagination-style-first {\r\n    display: none;\r\n  }\r\n\r\n  .pagination-style-second {\r\n    display: block;\r\n  }\r\n\r\n  .movie-strips {\r\n    margin-left: 1rem;\r\n    margin-right: 1rem;\r\n  }\r\n}\r\n\r\n</style>\r\n"]},"metadata":{},"sourceType":"module"}