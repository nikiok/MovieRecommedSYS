{"ast":null,"code":"import \"core-js/modules/es.error.cause.js\";\nimport { Lock as IconLock, User as IconUser } from \"@element-plus/icons\";\nimport { reactive, ref, unref } from \"vue\";\nimport { useRouter } from \"vue-router\";\nimport { ErrorMessage, SuccessMessage } from \"@/utils/my-message\";\nimport userRequest from \"@/api/user\";\nimport { debounce } from \"@/utils/debounce-throttle\";\nexport default {\n  name: 'RegisterView',\n  components: {\n    IconUser,\n    IconLock\n  },\n  setup() {\n    let router = useRouter();\n    let agree = ref(false);\n    const registerFormRef = ref('');\n    const registerForm = reactive({\n      username: '',\n      password: '',\n      checkPass: ''\n    });\n    const validateUser = (rule, value, callback) => {\n      const reg = /^[a-zA-Z0-9]+$/;\n      if (value === '') {\n        callback(new Error('请输入账号'));\n      } else if (value.length < 4 || value.length > 20) {\n        callback(new Error('长度在4到20个字符'));\n      } else if (!reg.test(value)) {\n        callback(new Error('只允许填写数字、字母'));\n      } else {\n        callback();\n      }\n    };\n    const validateUserChange = (rule, value, callback) => {\n      const reg = /^[a-zA-Z0-9]+$/;\n      if (!reg.test(value)) {\n        callback(new Error('只允许填写数字、字母'));\n      } else {\n        callback();\n      }\n    };\n    const validatePassBlur = (rule, value, callback) => {\n      const reg = /^[a-zA-Z0-9_!.@]+$/;\n      if (value === '') {\n        callback(new Error('请输入密码'));\n      } else if (value.length < 4 || value.length > 20) {\n        callback(new Error('长度在4到20个字符'));\n      } else if (!reg.test(value)) {\n        callback(new Error('只允许填写数字、字母、符号(_、!、.、@)'));\n      } else {\n        callback();\n      }\n    };\n    const validatePassChange = (rule, value, callback) => {\n      const reg = /^[a-zA-Z0-9_!.@]+$/;\n      if (!reg.test(value)) {\n        callback(new Error('只允许填写数字、字母、符号(_、!、.、@)'));\n      } else {\n        callback();\n      }\n    };\n    const validatePassAgainBlur = (rule, value, callback) => {\n      const reg = /^[a-zA-Z0-9_!.@]+$/;\n      if (value === '') {\n        callback(new Error('请再次输入密码'));\n      } else if (value.length < 4 || value.length > 20) {\n        callback(new Error('长度在4到20个字符'));\n      } else if (!reg.test(value)) {\n        callback(new Error('只允许填写数字、字母、符号(_、!、.、@)'));\n      } else if (value !== registerForm.password) {\n        callback(new Error(\"两次密码输入不一致\"));\n      } else {\n        callback();\n      }\n    };\n    const validateAgreeBlur = (rule, value, callback) => {\n      if (!agree.value) {\n        callback(new Error('您需要同意《注册协议》才能注册'));\n      } else {\n        callback();\n      }\n    };\n    const rules = reactive({\n      username: [{\n        required: true,\n        validator: validateUser,\n        trigger: 'blur'\n      }, {\n        validator: validateUserChange,\n        trigger: 'change'\n      }],\n      password: [{\n        required: true,\n        validator: validatePassBlur,\n        trigger: 'blur'\n      }, {\n        validator: validatePassChange,\n        trigger: 'change'\n      }],\n      checkPass: [{\n        required: true,\n        validator: validatePassAgainBlur,\n        trigger: 'blur'\n      }, {\n        validator: validatePassChange,\n        trigger: 'change'\n      }],\n      agree: [{\n        required: true,\n        validator: validateAgreeBlur,\n        trigger: 'blur'\n      }]\n    });\n    const postRegister = debounce(async () => {\n      const form = unref(registerFormRef);\n      if (!form) {\n        return;\n      }\n      try {\n        await form.validate();\n        userRequest.register(registerForm).then(res => {\n          if (res.code === 200) {\n            SuccessMessage(res.msg);\n            // 注册成功之后，进行页面跳转\n            router.replace(\"/login\");\n          } else {\n            ErrorMessage(res.msg);\n          }\n        }).catch(err => {\n          ErrorMessage(err);\n        });\n      } catch (err) {\n        console.error(err);\n      }\n    });\n    return {\n      agree,\n      registerFormRef,\n      registerForm,\n      rules,\n      postRegister\n    };\n  }\n};","map":{"version":3,"mappings":"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","names":["Lock","IconLock","User","IconUser","reactive","ref","unref","useRouter","ErrorMessage","SuccessMessage","userRequest","debounce","name","components","setup","router","agree","registerFormRef","registerForm","username","password","checkPass","validateUser","rule","value","callback","reg","Error","length","test","validateUserChange","validatePassBlur","validatePassChange","validatePassAgainBlur","validateAgreeBlur","rules","required","validator","trigger","postRegister","form","validate","register","then","res","code","msg","replace","catch","err","console","error"],"sourceRoot":"","sources":["F:\\personalSpace\\lx-bishe\\movie_recommendation_system_vue\\src\\views\\RegisterView.vue"],"sourcesContent":["<template>\r\n  <!--  <div class=\"bg\" style=\"background-image: url('https://api.xygeng.cn/Bing/')\"></div>-->\r\n  <div class=\"login-form my-border\" @keyup.enter=\"postRegister\">\r\n\r\n    <div class=\"login-form-header\">\r\n      <router-link to=\"/home\">\r\n        <img style=\"width: 75px; height: 75px; float: left; padding-right: 40px;\" src=\"../assets/logo.png\" alt=\"logo\"/>\r\n      </router-link>\r\n\r\n      <div class=\"login-form-text\">电影推荐系统 - 登录</div>\r\n    </div>\r\n\r\n    <el-form ref=\"registerFormRef\" :model=\"registerForm\" :rules=\"rules\">\r\n      <el-form-item label=\"账 号\" prop=\"username\">\r\n        <el-input\r\n            class=\"login-form-input\"\r\n            placeholder=\"账 号\"\r\n            v-model=\"registerForm.username\"\r\n            autofocus\r\n            autocomplete=\"off\"\r\n        >\r\n          <template #prefix>\r\n            <el-icon class=\"el-input__icon\">\r\n              <icon-user/>\r\n            </el-icon>\r\n          </template>\r\n        </el-input>\r\n      </el-form-item>\r\n\r\n      <el-form-item label=\"密 码\" prop=\"password\">\r\n        <el-input\r\n            class=\"login-form-input\"\r\n            placeholder=\"密 码\"\r\n            v-model=\"registerForm.password\"\r\n            show-password\r\n        >\r\n          <template #prefix>\r\n            <el-icon class=\"el-input__icon\">\r\n              <icon-lock/>\r\n            </el-icon>\r\n          </template>\r\n        </el-input>\r\n      </el-form-item>\r\n\r\n      <el-form-item label=\"确 认\" prop=\"checkPass\">\r\n        <el-input\r\n            class=\"login-form-input\"\r\n            placeholder=\"密 码 确 认\"\r\n            v-model=\"registerForm.checkPass\"\r\n            show-password\r\n        >\r\n          <template #prefix>\r\n            <el-icon class=\"el-input__icon\">\r\n              <icon-lock/>\r\n            </el-icon>\r\n          </template>\r\n        </el-input>\r\n      </el-form-item>\r\n\r\n      <el-form-item prop=\"agree\">\r\n        <el-checkbox v-model=\"agree\">我已同意\"电影推荐系统\"用户注册协议!</el-checkbox>\r\n      </el-form-item>\r\n\r\n      <el-form-item>\r\n        <el-button @click=\"postRegister\" class=\"login-form-button\" type=\"primary\">注 册</el-button>\r\n      </el-form-item>\r\n    </el-form>\r\n\r\n    <div class=\"login-form-footer\">\r\n      <el-link href=\"/login\" style=\"font-weight: bolder;font-size: 16px;color: #91949c;\" :underline=\"false\">\r\n        我有账号 去登录\r\n        <i style=\"font-weight: bolder; font-size: 15px\" class=\"el-icon-right\"></i>\r\n      </el-link>\r\n    </div>\r\n  </div>\r\n\r\n</template>\r\n\r\n<script>\r\nimport {Lock as IconLock, User as IconUser} from \"@element-plus/icons\";\r\nimport {reactive, ref, unref} from \"vue\";\r\nimport {useRouter} from \"vue-router\";\r\nimport {ErrorMessage, SuccessMessage} from \"@/utils/my-message\";\r\nimport userRequest from \"@/api/user\";\r\nimport {debounce} from \"@/utils/debounce-throttle\";\r\n\r\nexport default {\r\n  name: 'RegisterView',\r\n  components: {\r\n    IconUser,\r\n    IconLock,\r\n  },\r\n  setup() {\r\n    let router = useRouter()\r\n    let agree = ref(false)\r\n    const registerFormRef = ref('')\r\n\r\n    const registerForm = reactive({\r\n      username: '',\r\n      password: '',\r\n      checkPass: '',\r\n    })\r\n\r\n    const validateUser = (rule, value, callback) => {\r\n      const reg = /^[a-zA-Z0-9]+$/\r\n      if (value === '') {\r\n        callback(new Error('请输入账号'))\r\n      } else if (value.length < 4 || value.length > 20) {\r\n        callback(new Error('长度在4到20个字符'))\r\n      } else if (!reg.test(value)) {\r\n        callback(new Error('只允许填写数字、字母'))\r\n      } else {\r\n        callback()\r\n      }\r\n    }\r\n    const validateUserChange = (rule, value, callback) => {\r\n      const reg = /^[a-zA-Z0-9]+$/\r\n      if (!reg.test(value)) {\r\n        callback(new Error('只允许填写数字、字母'))\r\n      } else {\r\n        callback()\r\n      }\r\n    }\r\n    const validatePassBlur = (rule, value, callback) => {\r\n      const reg = /^[a-zA-Z0-9_!.@]+$/\r\n      if (value === '') {\r\n        callback(new Error('请输入密码'))\r\n      } else if (value.length < 4 || value.length > 20) {\r\n        callback(new Error('长度在4到20个字符'))\r\n      } else if (!reg.test(value)) {\r\n        callback(new Error('只允许填写数字、字母、符号(_、!、.、@)'))\r\n      } else {\r\n        callback()\r\n      }\r\n    }\r\n    const validatePassChange = (rule, value, callback) => {\r\n      const reg = /^[a-zA-Z0-9_!.@]+$/\r\n      if (!reg.test(value)) {\r\n        callback(new Error('只允许填写数字、字母、符号(_、!、.、@)'))\r\n      } else {\r\n        callback()\r\n      }\r\n    }\r\n    const validatePassAgainBlur = (rule, value, callback) => {\r\n      const reg = /^[a-zA-Z0-9_!.@]+$/\r\n      if (value === '') {\r\n        callback(new Error('请再次输入密码'))\r\n      } else if (value.length < 4 || value.length > 20) {\r\n        callback(new Error('长度在4到20个字符'))\r\n      } else if (!reg.test(value)) {\r\n        callback(new Error('只允许填写数字、字母、符号(_、!、.、@)'))\r\n      } else if (value !== registerForm.password) {\r\n        callback(new Error(\"两次密码输入不一致\"))\r\n      } else {\r\n        callback()\r\n      }\r\n    }\r\n    const validateAgreeBlur = (rule, value, callback) => {\r\n      if (!agree.value) {\r\n        callback(new Error('您需要同意《注册协议》才能注册'))\r\n      } else {\r\n        callback()\r\n      }\r\n    }\r\n    const rules = reactive({\r\n      username: [\r\n        {required: true, validator: validateUser, trigger: 'blur'},\r\n        {validator: validateUserChange, trigger: 'change'}\r\n      ],\r\n      password: [\r\n        {required: true, validator: validatePassBlur, trigger: 'blur'},\r\n        {validator: validatePassChange, trigger: 'change'}\r\n      ],\r\n      checkPass: [\r\n        {required: true, validator: validatePassAgainBlur, trigger: 'blur'},\r\n        {validator: validatePassChange, trigger: 'change'}\r\n      ],\r\n      agree: [\r\n        {required: true, validator: validateAgreeBlur, trigger: 'blur'}\r\n      ]\r\n    })\r\n\r\n    const postRegister = debounce(async () => {\r\n      const form = unref(registerFormRef)\r\n      if (!form) {\r\n        return\r\n      }\r\n      try {\r\n        await form.validate()\r\n        userRequest.register(registerForm).then(res => {\r\n          if (res.code === 200) {\r\n            SuccessMessage(res.msg)\r\n            // 注册成功之后，进行页面跳转\r\n            router.replace(\"/login\")\r\n          } else {\r\n            ErrorMessage(res.msg)\r\n          }\r\n        }).catch(err => {\r\n          ErrorMessage(err)\r\n        })\r\n      } catch (err) {\r\n        console.error(err)\r\n      }\r\n    })\r\n\r\n    return {\r\n      agree,\r\n      registerFormRef,\r\n      registerForm,\r\n      rules,\r\n      postRegister,\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.bg {\r\n  height: 100%;\r\n  width: 100%;\r\n  position: absolute;\r\n  background-size: cover;\r\n}\r\n\r\n.login-form {\r\n  width: 28rem;\r\n  position: absolute;\r\n  left: 50%;\r\n  top: 10rem;\r\n  transform: translate(-50%, 0);\r\n  padding: 2rem;\r\n  margin-top: 1rem;\r\n  letter-spacing: 2px;\r\n}\r\n\r\n.login-form-header {\r\n  height: 20px;\r\n  padding-left: 45px;\r\n  padding-bottom: 100px;\r\n}\r\n\r\n.login-form-text {\r\n  color: #000000;\r\n  font-weight: bold;\r\n  font-size: 1.8rem;\r\n  padding-top: 15px;\r\n}\r\n\r\n.login-form-input {\r\n  margin-bottom: 10px;\r\n}\r\n\r\n.login-form-button {\r\n  border-radius: 3px;\r\n  width: 100%;\r\n  font-weight: 600;\r\n  font-size: 15px;\r\n  letter-spacing: 2px;\r\n  height: 3.5rem;\r\n  background: #5a84fd;\r\n  margin-top: 35px;\r\n}\r\n\r\n.login-form-button:hover {\r\n  box-shadow: 0 10px 30px #2156f6;\r\n  transition: 3s;\r\n}\r\n\r\n.login-form-footer {\r\n  font-weight: bolder;\r\n  color: #91949c;\r\n  padding-top: 1.5rem;\r\n  text-align: center;\r\n}\r\n\r\n>>> .el-input__inner {\r\n  height: 3rem;\r\n}\r\n\r\n.el-checkbox {\r\n  color: #91949c;\r\n  font-weight: bolder;\r\n  font-size: 15px;\r\n}\r\n\r\n/deep/ .el-form-item__label {\r\n  color: #91949c;\r\n  font-weight: bold;\r\n}\r\n\r\n/deep/ .el-form-item {\r\n  align-items: baseline;\r\n}\r\n</style>\r\n"]},"metadata":{},"sourceType":"module"}