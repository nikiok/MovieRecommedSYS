{"ast":null,"code":"import { computed, ref, watch } from \"vue\";\nimport commentRequest from \"@/api/comment\";\nimport { throttle } from \"@/utils/debounce-throttle\";\nexport default {\n  name: \"CommentStrip\",\n  props: {\n    comment: {\n      type: Object,\n      default: {\n        id: '',\n        avatar: '',\n        nickname: '',\n        score: 0,\n        time: '',\n        comment: '',\n        agree: 0,\n        status: 0\n      }\n    },\n    isOwn: {\n      type: Boolean,\n      default: false\n    }\n  },\n  setup(props) {\n    const cid = props.comment.id;\n    // 点赞状态\n    let status = ref(props.comment.status);\n    let score = computed(() => {\n      return props.comment.score / 2;\n    });\n    const handleLike = throttle(() => {\n      status.value = !status.value;\n      if (status.value) props.comment.agree++;else props.comment.agree--;\n      const t = status.value === true ? 1 : 0;\n      commentRequest.likeComment(cid, t).catch(err => {\n        console.error(err);\n      });\n    }, 500);\n    return {\n      status,\n      score,\n      handleLike\n    };\n  }\n};","map":{"version":3,"mappings":"AA0CA,SAAQA,QAAQ,EAAEC,GAAG,EAAEC,KAAK,QAAO,KAAK;AACxC,OAAOC,cAAa,MAAO,eAAe;AAC1C,SAAQC,QAAQ,QAAO,2BAA2B;AAElD,eAAe;EACbC,IAAI,EAAE,cAAc;EACpBC,KAAK,EAAE;IACLC,OAAO,EAAE;MACPC,IAAI,EAAEC,MAAM;MACZC,OAAO,EAAE;QACPC,EAAE,EAAE,EAAE;QACNC,MAAM,EAAE,EAAE;QACVC,QAAQ,EAAE,EAAE;QACZC,KAAK,EAAE,CAAC;QACRC,IAAI,EAAE,EAAE;QACRR,OAAO,EAAE,EAAE;QACXS,KAAK,EAAE,CAAC;QACRC,MAAM,EAAE;MACV;IACF,CAAC;IACDC,KAAK,EAAE;MACLV,IAAI,EAAEW,OAAO;MACbT,OAAO,EAAE;IACX;EACF,CAAC;EACDU,KAAKA,CAACd,KAAK,EAAE;IACX,MAAMe,GAAE,GAAIf,KAAK,CAACC,OAAO,CAACI,EAAE;IAC5B;IACA,IAAIM,MAAK,GAAIhB,GAAG,CAACK,KAAK,CAACC,OAAO,CAACU,MAAM,CAAC;IACtC,IAAIH,KAAI,GAAId,QAAQ,CAAC,MAAM;MACzB,OAAOM,KAAK,CAACC,OAAO,CAACO,KAAI,GAAI,CAAC;IAChC,CAAC;IAED,MAAMQ,UAAS,GAAIlB,QAAQ,CAAC,MAAM;MAChCa,MAAM,CAACM,KAAI,GAAI,CAACN,MAAM,CAACM,KAAK;MAC5B,IAAIN,MAAM,CAACM,KAAK,EAAEjB,KAAK,CAACC,OAAO,CAACS,KAAK,EAAE,MAClCV,KAAK,CAACC,OAAO,CAACS,KAAK,EAAE;MAC1B,MAAMQ,IAAIP,MAAM,CAACM,KAAI,KAAM,IAAG,GAAI,IAAI,CAAC;MACvCpB,cAAc,CAACsB,WAAW,CAACJ,GAAG,EAAEG,CAAC,CAAC,CAACE,KAAK,CAACC,GAAE,IAAK;QAC9CC,OAAO,CAACC,KAAK,CAACF,GAAG,CAAC;MACpB,CAAC,CAAC;IACJ,CAAC,EAAE,GAAG;IAEN,OAAO;MACLV,MAAM;MACNH,KAAK;MACLQ;IACF;EACF;AACF","names":["computed","ref","watch","commentRequest","throttle","name","props","comment","type","Object","default","id","avatar","nickname","score","time","agree","status","isOwn","Boolean","setup","cid","handleLike","value","t","likeComment","catch","err","console","error"],"sourceRoot":"","sources":["F:\\personalSpace\\lx-bishe\\movie_recommendation_system_vue\\src\\components\\basic\\CommentStrip.vue"],"sourcesContent":["<template>\r\n  <div class=\"comment-strip-master\">\r\n    <div class=\"comment-header\">\r\n      <el-avatar :src=\"comment.avatar\" @error=\"true\">\r\n        <!-- 当图片加载错误时，将加载这里面的图片 -->\r\n        <img src=\"../../assets/default_avatar.png\" alt=\"default_avatar\"/>\r\n      </el-avatar>\r\n\r\n      <div class=\"right\">\r\n        <div class=\"name\">{{ comment.nickname }}</div>\r\n        <div class=\"score-and-time\">\r\n          <span>\r\n            <el-rate v-model=\"score\" disabled/>\r\n          </span>\r\n          <span>{{ comment.time }}</span>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n    <div class=\"comment-middle\">\r\n      <p v-if=\"comment.comment\" class=\"comment-content\">{{ comment.comment }}</p>\r\n      <p v-else style=\"color: #a89e9e\">该用户很懒，啥也没写。</p>\r\n      <slot name=\"movieInfo\"></slot>\r\n    </div>\r\n\r\n    <div v-if=\"!isOwn\" class=\"comment-bottom\">\r\n      <!-- out-in 当前元素先进行过渡，完成之后新元素过渡进入。 -->\r\n      <transition\r\n          name=\"fade\" mode=\"out-in\"\r\n          enter-active-class=\"animate__animated animate__fadeIn\"\r\n          leave-active-class=\"animate__animated animate__fadeOut\"\r\n          :duration=\"150\">\r\n        <svg-icon v-if=\"!status\" @click=\"handleLike\" icon-class=\"no_like_1\"\r\n                  style=\"width: 1rem; height: 1rem;\"></svg-icon>\r\n        <svg-icon v-else @click=\"handleLike\" icon-class=\"liked_1\" style=\"width: 1rem; height: 1rem;\"></svg-icon>\r\n      </transition>\r\n      <span class=\"agree\">{{ comment.agree }}</span>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport {computed, ref, watch} from \"vue\";\r\nimport commentRequest from \"@/api/comment\";\r\nimport {throttle} from \"@/utils/debounce-throttle\";\r\n\r\nexport default {\r\n  name: \"CommentStrip\",\r\n  props: {\r\n    comment: {\r\n      type: Object,\r\n      default: {\r\n        id: '',\r\n        avatar: '',\r\n        nickname: '',\r\n        score: 0,\r\n        time: '',\r\n        comment: '',\r\n        agree: 0,\r\n        status: 0,\r\n      }\r\n    },\r\n    isOwn: {\r\n      type: Boolean,\r\n      default: false\r\n    }\r\n  },\r\n  setup(props) {\r\n    const cid = props.comment.id;\r\n    // 点赞状态\r\n    let status = ref(props.comment.status);\r\n    let score = computed(() => {\r\n      return props.comment.score / 2;\r\n    })\r\n\r\n    const handleLike = throttle(() => {\r\n      status.value = !status.value;\r\n      if (status.value) props.comment.agree++;\r\n      else props.comment.agree--;\r\n      const t = status.value === true ? 1 : 0;\r\n      commentRequest.likeComment(cid, t).catch(err => {\r\n        console.error(err);\r\n      });\r\n    }, 500)\r\n\r\n    return {\r\n      status,\r\n      score,\r\n      handleLike,\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n.comment-header {\r\n  display: flex;\r\n  align-items: center;\r\n\r\n  .right {\r\n    margin-left: 1rem;\r\n\r\n    .name {\r\n      font-size: 1.2rem;\r\n    }\r\n\r\n    .score-and-time {\r\n      display: flex;\r\n      align-items: center;\r\n      font-size: 0.8rem;\r\n      color: #91949c;\r\n    }\r\n  }\r\n}\r\n\r\n.comment-middle {\r\n  margin-left: 2rem;\r\n\r\n  .comment-content {\r\n    // 参考链接：https://blog.csdn.net/iceking66/article/details/78253186\r\n    // 保留空白符序列，但是正常地进行换行。\r\n    white-space: pre-wrap;\r\n  }\r\n}\r\n\r\n.comment-bottom {\r\n  display: flex;\r\n  align-items: center;\r\n\r\n  .agree {\r\n    margin-left: 0.3rem;\r\n    font-size: 0.8rem;\r\n    color: #91949c;\r\n  }\r\n}\r\n</style>"]},"metadata":{},"sourceType":"module"}