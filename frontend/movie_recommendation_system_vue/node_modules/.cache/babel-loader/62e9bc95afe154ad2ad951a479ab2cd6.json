{"ast":null,"code":"import { createCommentVNode as _createCommentVNode, createElementVNode as _createElementVNode, resolveComponent as _resolveComponent, createVNode as _createVNode, createTextVNode as _createTextVNode, withCtx as _withCtx, withKeys as _withKeys, openBlock as _openBlock, createElementBlock as _createElementBlock, Transition as _Transition, createBlock as _createBlock, toDisplayString as _toDisplayString, Fragment as _Fragment, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\";\nimport _imports_0 from '../../assets/logo.png';\nimport _imports_1 from '../../assets/default_avatar.png';\nconst _withScopeId = n => (_pushScopeId(\"data-v-5ea23730\"), n = n(), _popScopeId(), n);\nconst _hoisted_1 = {\n  class: \"navbar\"\n};\nconst _hoisted_2 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"div\", {\n  class: \"logo\"\n}, [/*#__PURE__*/_createElementVNode(\"img\", {\n  src: _imports_0,\n  alt: \"logo\"\n}), /*#__PURE__*/_createElementVNode(\"span\", {\n  class: \"title\"\n}, \"电影推荐系统\")], -1 /* HOISTED */));\nconst _hoisted_3 = {\n  ref: \"moreRef\"\n};\nconst _hoisted_4 = {\n  key: 0,\n  ref: \"mainMenuRef\",\n  class: \"menu\"\n};\nconst _hoisted_5 = /*#__PURE__*/_createTextVNode(\"首页\");\nconst _hoisted_6 = /*#__PURE__*/_createTextVNode(\"分类\");\nconst _hoisted_7 = {\n  class: \"search-div\"\n};\nconst _hoisted_8 = {\n  class: \"big-menu\"\n};\nconst _hoisted_9 = /*#__PURE__*/_createTextVNode(\"首页\");\nconst _hoisted_10 = /*#__PURE__*/_createTextVNode(\"分类\");\nconst _hoisted_11 = {\n  class: \"search-div\"\n};\nconst _hoisted_12 = /*#__PURE__*/_createTextVNode(\" 登录 \");\nconst _hoisted_13 = {\n  class: \"login-name\"\n};\nconst _hoisted_14 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"img\", {\n  src: _imports_1,\n  alt: \"default avatar\"\n}, null, -1 /* HOISTED */));\nconst _hoisted_15 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"i\", {\n  style: {\n    \"padding-right\": \"3px\"\n  }\n}, null, -1 /* HOISTED */));\nconst _hoisted_16 = /*#__PURE__*/_createTextVNode(\"我的主页 \");\nconst _hoisted_17 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"i\", {\n  style: {\n    \"padding-right\": \"3px\"\n  }\n}, null, -1 /* HOISTED */));\nconst _hoisted_18 = /*#__PURE__*/_createTextVNode(\"电影星球 \");\nconst _hoisted_19 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"i\", {\n  style: {\n    \"padding-right\": \"3px\"\n  }\n}, null, -1 /* HOISTED */));\nconst _hoisted_20 = /*#__PURE__*/_createTextVNode(\"个人设置 \");\nconst _hoisted_21 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"i\", {\n  style: {\n    \"padding-right\": \"3px\"\n  }\n}, null, -1 /* HOISTED */));\nconst _hoisted_22 = /*#__PURE__*/_createTextVNode(\"退出登录 \");\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_menu_icon = _resolveComponent(\"menu-icon\");\n  const _component_el_link = _resolveComponent(\"el-link\");\n  const _component_search = _resolveComponent(\"search\");\n  const _component_el_autocomplete = _resolveComponent(\"el-autocomplete\");\n  const _component_el_avatar = _resolveComponent(\"el-avatar\");\n  const _component_el_button = _resolveComponent(\"el-button\");\n  const _component_el_dropdown_item = _resolveComponent(\"el-dropdown-item\");\n  const _component_el_dropdown_menu = _resolveComponent(\"el-dropdown-menu\");\n  const _component_el_dropdown = _resolveComponent(\"el-dropdown\");\n  return _openBlock(), _createElementBlock(_Fragment, null, [_createCommentVNode(\" 导航栏 \"), _createElementVNode(\"div\", _hoisted_1, [_hoisted_2, _createElementVNode(\"div\", {\n    onClick: _cache[0] || (_cache[0] = (...args) => $setup.handleMainMenu && $setup.handleMainMenu(...args)),\n    class: \"menu-icon\"\n  }, [_createElementVNode(\"div\", _hoisted_3, [_createVNode(_component_menu_icon, {\n    color: `${$setup.iconColor}`\n  }, null, 8 /* PROPS */, [\"color\"])], 512 /* NEED_PATCH */)]), _createCommentVNode(\" 小屏时显示这个菜单 \"), _createVNode(_Transition, {\n    name: \"animate__animated animate__bounce\",\n    appear: \"\",\n    \"enter-active-class\": \"animate__fadeInLeft\",\n    \"leave-active-class\": \"animate__fadeOut\"\n  }, {\n    default: _withCtx(() => [$setup.isShowMenu ? (_openBlock(), _createElementBlock(\"div\", _hoisted_4, [_createVNode(_component_el_link, {\n      onClick: _cache[1] || (_cache[1] = $event => $setup.show('home')),\n      underline: false\n    }, {\n      default: _withCtx(() => [_hoisted_5]),\n      _: 1 /* STABLE */\n    }), _createVNode(_component_el_link, {\n      onClick: _cache[2] || (_cache[2] = $event => $setup.show('classification')),\n      underline: false\n    }, {\n      default: _withCtx(() => [_hoisted_6]),\n      _: 1 /* STABLE */\n    }), _createElementVNode(\"span\", _hoisted_7, [_createVNode(_component_el_autocomplete, {\n      modelValue: $setup.searchKeywords,\n      \"onUpdate:modelValue\": _cache[3] || (_cache[3] = $event => $setup.searchKeywords = $event),\n      \"fetch-suggestions\": $setup.querySearchAsync,\n      placeholder: \"请输入电影名\",\n      onSelect: $setup.handleSelect,\n      onKeydown: _withKeys($setup.handleSearch, [\"enter\"])\n    }, {\n      suffix: _withCtx(() => [_createVNode(_component_search, {\n        onClick: $setup.handleSearch,\n        width: \"20px\"\n      }, null, 8 /* PROPS */, [\"onClick\"])]),\n      _: 1 /* STABLE */\n    }, 8 /* PROPS */, [\"modelValue\", \"fetch-suggestions\", \"onSelect\", \"onKeydown\"])])], 512 /* NEED_PATCH */)) : _createCommentVNode(\"v-if\", true)]),\n    _: 1 /* STABLE */\n  }), _createCommentVNode(\" 大屏时显示这个菜单 \"), _createElementVNode(\"div\", _hoisted_8, [_createVNode(_component_el_link, {\n    onClick: _cache[4] || (_cache[4] = $event => $setup.show('home')),\n    underline: false\n  }, {\n    default: _withCtx(() => [_hoisted_9]),\n    _: 1 /* STABLE */\n  }), _createVNode(_component_el_link, {\n    onClick: _cache[5] || (_cache[5] = $event => $setup.show('classification')),\n    underline: false\n  }, {\n    default: _withCtx(() => [_hoisted_10]),\n    _: 1 /* STABLE */\n  }), _createElementVNode(\"span\", _hoisted_11, [_createVNode(_component_el_autocomplete, {\n    modelValue: $setup.searchKeywords,\n    \"onUpdate:modelValue\": _cache[6] || (_cache[6] = $event => $setup.searchKeywords = $event),\n    \"fetch-suggestions\": $setup.querySearchAsync,\n    placeholder: \"请输入电影名\",\n    onSelect: $setup.handleSelect,\n    onKeydown: _withKeys($setup.handleSearch, [\"enter\"])\n  }, {\n    suffix: _withCtx(() => [_createVNode(_component_search, {\n      onClick: $setup.handleSearch,\n      width: \"20px\"\n    }, null, 8 /* PROPS */, [\"onClick\"])]),\n    _: 1 /* STABLE */\n  }, 8 /* PROPS */, [\"modelValue\", \"fetch-suggestions\", \"onSelect\", \"onKeydown\"])])]), !$setup.isLogin ? (_openBlock(), _createBlock(_component_el_link, {\n    key: 0,\n    class: \"login-link\",\n    onClick: $setup.handleLogin,\n    underline: false\n  }, {\n    default: _withCtx(() => [_hoisted_12]),\n    _: 1 /* STABLE */\n  }, 8 /* PROPS */, [\"onClick\"])) : _createCommentVNode(\"v-if\", true), $setup.isLogin ? (_openBlock(), _createBlock(_component_el_dropdown, {\n    key: 1,\n    class: \"login-dropdown\"\n  }, {\n    dropdown: _withCtx(() => [_createVNode(_component_el_dropdown_menu, null, {\n      default: _withCtx(() => [_createVNode(_component_el_dropdown_item, null, {\n        default: _withCtx(() => [_createVNode(_component_el_link, {\n          underline: false,\n          onClick: _cache[7] || (_cache[7] = $event => $setup.show('personal')),\n          style: {\n            \"padding-right\": \"7px\"\n          }\n        }, {\n          default: _withCtx(() => [_hoisted_15, _hoisted_16]),\n          _: 1 /* STABLE */\n        })]),\n\n        _: 1 /* STABLE */\n      }), _createVNode(_component_el_dropdown_item, null, {\n        default: _withCtx(() => [_createVNode(_component_el_link, {\n          underline: false,\n          onClick: _cache[8] || (_cache[8] = $event => $setup.show('personalPlanet')),\n          style: {\n            \"padding-right\": \"7px\"\n          }\n        }, {\n          default: _withCtx(() => [_hoisted_17, _hoisted_18]),\n          _: 1 /* STABLE */\n        })]),\n\n        _: 1 /* STABLE */\n      }), _createVNode(_component_el_dropdown_item, null, {\n        default: _withCtx(() => [_createVNode(_component_el_link, {\n          underline: false,\n          onClick: _cache[9] || (_cache[9] = $event => $setup.show('setting')),\n          style: {\n            \"padding-right\": \"7px\"\n          }\n        }, {\n          default: _withCtx(() => [_hoisted_19, _hoisted_20]),\n          _: 1 /* STABLE */\n        })]),\n\n        _: 1 /* STABLE */\n      }), _createVNode(_component_el_dropdown_item, {\n        divided: \"\"\n      }, {\n        default: _withCtx(() => [_createVNode(_component_el_button, {\n          type: \"text\",\n          onClick: $setup.handleLogout,\n          underline: false\n        }, {\n          default: _withCtx(() => [_hoisted_21, _hoisted_22]),\n          _: 1 /* STABLE */\n        }, 8 /* PROPS */, [\"onClick\"])]),\n        _: 1 /* STABLE */\n      })]),\n\n      _: 1 /* STABLE */\n    })]),\n\n    default: _withCtx(() => [_createVNode(_component_el_button, {\n      type: \"text\"\n    }, {\n      default: _withCtx(() => [_createElementVNode(\"div\", _hoisted_13, _toDisplayString($setup.user.nickname), 1 /* TEXT */), _createVNode(_component_el_avatar, {\n        src: $setup.user.avatar,\n        onError: $setup.errorHandler\n      }, {\n        default: _withCtx(() => [_createCommentVNode(\" 当图片加载错误时，将加载这里面的图片 \"), _hoisted_14]),\n        _: 1 /* STABLE */\n      }, 8 /* PROPS */, [\"src\", \"onError\"])]),\n      _: 1 /* STABLE */\n    })]),\n\n    _: 1 /* STABLE */\n  })) : _createCommentVNode(\"v-if\", true)])], 2112 /* STABLE_FRAGMENT, DEV_ROOT_FRAGMENT */);\n}","map":{"version":3,"mappings":";OAIWA,UAA2B;OA2EvBC,UAAqC;;;EA7E7CC,KAAK,EAAC;AAAQ;gEACjBC,oBAGM;EAHDD,KAAK,EAAC;AAAM,iBACfC,oBAA6C;EAAxCC,GAA2B,EAA3BJ,UAA2B;EAACK,GAAG,EAAC;iBACrCF,oBAAiC;EAA3BD,KAAK,EAAC;AAAO,GAAC,QAAM;;EAIrBI,GAAG,EAAC;AAAS;;;EAadA,GAAG,EAAC,aAAa;EACjBJ,KAAK,EAAC;;iDAC0C,IAAE;iDACQ,IAAE;;EAExDA,KAAK,EAAC;AAAY;;EAiBvBA,KAAK,EAAC;AAAU;iDAC+B,IAAE;kDACQ,IAAE;;EAExDA,KAAK,EAAC;AAAY;kDAoBH,MAEvB;;EAISA,KAAK,EAAC;AAAY;iEAKrBC,oBAAiE;EAA5DC,GAAqC,EAArCH,UAAqC;EAACI,GAAG,EAAC;;iEAQ3CF,oBAAkC;EAA/BI,KAA0B,EAA1B;IAAA;EAAA;AAA0B;kDAAK,OACpC;iEAIEJ,oBAAkC;EAA/BI,KAA0B,EAA1B;IAAA;EAAA;AAA0B;kDAAK,OACpC;iEAIEJ,oBAAkC;EAA/BI,KAA0B,EAA1B;IAAA;EAAA;AAA0B;kDAAK,OACpC;iEAIEJ,oBAAkC;EAA/BI,KAA0B,EAA1B;IAAA;EAAA;AAA0B;kDAAK,OACpC;;;;;;;;;;;6DAtGVC,4BAAY,EACZL,oBA0GM,OA1GNM,UA0GM,GAzGJC,UAGM,EAENP,oBAIM;IAJAQ,OAAK,yCAAEC,uDAAc;IAAEV,KAAK,EAAC;MACjCC,oBAEM,OAFNU,UAEM,GADJC,aAA+CC;IAAnCC,KAAK,KAAKJ,gBAAS;gEAInCJ,kCAAkB,EAClBM,aA0BaG;IAzBTC,IAAI,EAAC,mCAAmC;IACxCC,MAAM,EAAN,EAAM;IACN,oBAAkB,EAAC,qBAAqB;IACxC,oBAAkB,EAAC;;sBACrB,MAoBM,CAnBIP,iBAAU,kBADpBQ,oBAoBM,OApBNC,UAoBM,GAhBJP,aAA8DQ;MAApDX,OAAK,sCAAEC,WAAI;MAAWW,SAAS,EAAE;;wBAAO,MAAE;;QACpDT,aAAwEQ;MAA9DX,OAAK,sCAAEC,WAAI;MAAqBW,SAAS,EAAE;;wBAAO,MAAE;;QAE9DpB,oBAYO,QAZPqB,UAYO,GAXLV,aAUkBW;kBATLb,qBAAc;iEAAdA,qBAAc;MACtB,mBAAiB,EAAEA,uBAAgB;MACpCc,WAAW,EAAC,QAAQ;MACnBC,QAAM,EAAEf,mBAAY;MACpBgB,SAAO,YAAQhB,mBAAY;;MAEnBiB,MAAM,WACf,MAA4C,CAA5Cf,aAA4CgB;QAAnCnB,OAAK,EAAEC,mBAAY;QAAEmB,KAAK,EAAC;;;;;MAO9CvB,kCAAkB,EAClBL,oBAiBM,OAjBN6B,UAiBM,GAhBJlB,aAA8DQ;IAApDX,OAAK,sCAAEC,WAAI;IAAWW,SAAS,EAAE;;sBAAO,MAAE;;MACpDT,aAAwEQ;IAA9DX,OAAK,sCAAEC,WAAI;IAAqBW,SAAS,EAAE;;sBAAO,MAAE;;MAE9DpB,oBAYO,QAZP8B,WAYO,GAXLnB,aAUkBW;gBATLb,qBAAc;+DAAdA,qBAAc;IACtB,mBAAiB,EAAEA,uBAAgB;IACpCc,WAAW,EAAC,QAAQ;IACnBC,QAAM,EAAEf,mBAAY;IACpBgB,SAAO,YAAQhB,mBAAY;;IAEnBiB,MAAM,WACf,MAA4C,CAA5Cf,aAA4CgB;MAAnCnB,OAAK,EAAEC,mBAAY;MAAEmB,KAAK,EAAC;;;wFASjCnB,cAAO,kBAFlBsB,aAMUZ;;IALNpB,KAAK,EAAC,YAAY;IAEjBS,OAAK,EAAEC,kBAAW;IAClBW,SAAS,EAAE;;sBAAO,MAEvB;;uEAE0CX,cAAO,kBAAjDsB,aAmCcC;;IAnCDjC,KAAK,EAAC;;IAWNkC,QAAQ,WACjB,MAqBmB,CArBnBtB,aAqBmBuB;wBApBjB,MAImB,CAJnBvB,aAImBwB;0BAHjB,MAEU,CAFVxB,aAEUQ;UAFAC,SAAS,EAAE,KAAK;UAAGZ,OAAK,sCAAEC,WAAI;UAAcL,KAA0B,EAA1B;YAAA;UAAA;;4BACpD,MAAkC,CAAlCgC,WAAkC;;;;;UAGtCzB,aAImBwB;0BAHjB,MAEU,CAFVxB,aAEUQ;UAFAC,SAAS,EAAE,KAAK;UAAGZ,OAAK,sCAAEC,WAAI;UAAoBL,KAA0B,EAA1B;YAAA;UAAA;;4BAC1D,MAAkC,CAAlCiC,WAAkC;;;;;UAGtC1B,aAImBwB;0BAHjB,MAEU,CAFVxB,aAEUQ;UAFAC,SAAS,EAAE,KAAK;UAAGZ,OAAK,sCAAEC,WAAI;UAAaL,KAA0B,EAA1B;YAAA;UAAA;;4BACnD,MAAkC,CAAlCkC,WAAkC;;;;;UAGtC3B,aAImBwB;QAJDI,OAAO,EAAP;MAAO;0BACvB,MAEY,CAFZ5B,aAEY6B;UAFDC,IAAI,EAAC,MAAM;UAAEjC,OAAK,EAAEC,mBAAY;UAAGW,SAAS,EAAE;;4BACvD,MAAkC,CAAlCsB,WAAkC;;;;;;;;;sBA7B1C,MAQY,CARZ/B,aAQY6B;MARDC,IAAI,EAAC;IAAM;wBACpB,MAEM,CAFNzC,oBAEM,OAFN2C,WAEM,mBADDlC,WAAI,CAACmC,QAAQ,kBAElBjC,aAGYkC;QAHA5C,GAAG,EAAEQ,WAAI,CAACqC,MAAM;QAAGC,OAAK,EAAEtC;;0BACpC,MAA2B,CAA3BJ,2CAA2B,EAC3B2C,WAAiE","names":["_imports_0","_imports_1","class","_createElementVNode","src","alt","ref","style","_createCommentVNode","_hoisted_1","_hoisted_2","onClick","$setup","_hoisted_3","_createVNode","_component_menu_icon","color","_Transition","name","appear","_createElementBlock","_hoisted_4","_component_el_link","underline","_hoisted_7","_component_el_autocomplete","placeholder","onSelect","onKeydown","suffix","_component_search","width","_hoisted_8","_hoisted_11","_createBlock","_component_el_dropdown","dropdown","_component_el_dropdown_menu","_component_el_dropdown_item","_hoisted_15","_hoisted_17","_hoisted_19","divided","_component_el_button","type","_hoisted_21","_hoisted_13","nickname","_component_el_avatar","avatar","onError","_hoisted_14"],"sourceRoot":"","sources":["F:\\personalSpace\\lx-bishe\\movie_recommendation_system_vue\\src\\components\\layout\\MovieHeader.vue"],"sourcesContent":["<template>\r\n  <!-- 导航栏 -->\r\n  <div class=\"navbar\">\r\n    <div class=\"logo\">\r\n      <img src=\"../../assets/logo.png\" alt=\"logo\"/>\r\n      <span class=\"title\">电影推荐系统</span>\r\n    </div>\r\n\r\n    <div @click=\"handleMainMenu\" class=\"menu-icon\">\r\n      <div ref=\"moreRef\">\r\n        <menu-icon :color=\"`${iconColor}`\"></menu-icon>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- 小屏时显示这个菜单 -->\r\n    <transition\r\n        name=\"animate__animated animate__bounce\"\r\n        appear\r\n        enter-active-class=\"animate__fadeInLeft\"\r\n        leave-active-class=\"animate__fadeOut\">\r\n      <div\r\n          v-if=\"isShowMenu\"\r\n          ref=\"mainMenuRef\"\r\n          class=\"menu\">\r\n        <el-link @click=\"show('home')\" :underline=\"false\">首页</el-link>\r\n        <el-link @click=\"show('classification')\" :underline=\"false\">分类</el-link>\r\n\r\n        <span class=\"search-div\">\r\n          <el-autocomplete\r\n              v-model=\"searchKeywords\"\r\n              :fetch-suggestions=\"querySearchAsync\"\r\n              placeholder=\"请输入电影名\"\r\n              @select=\"handleSelect\"\r\n              @keydown.enter=\"handleSearch\"\r\n          >\r\n            <template #suffix>\r\n              <search @click=\"handleSearch\" width=\"20px\"/>\r\n            </template>\r\n          </el-autocomplete>\r\n        </span>\r\n      </div>\r\n    </transition>\r\n\r\n    <!-- 大屏时显示这个菜单 -->\r\n    <div class=\"big-menu\">\r\n      <el-link @click=\"show('home')\" :underline=\"false\">首页</el-link>\r\n      <el-link @click=\"show('classification')\" :underline=\"false\">分类</el-link>\r\n\r\n      <span class=\"search-div\">\r\n        <el-autocomplete\r\n            v-model=\"searchKeywords\"\r\n            :fetch-suggestions=\"querySearchAsync\"\r\n            placeholder=\"请输入电影名\"\r\n            @select=\"handleSelect\"\r\n            @keydown.enter=\"handleSearch\"\r\n        >\r\n          <template #suffix>\r\n            <search @click=\"handleSearch\" width=\"20px\"/>\r\n          </template>\r\n        </el-autocomplete>\r\n      </span>\r\n    </div>\r\n\r\n\r\n    <el-link\r\n        class=\"login-link\"\r\n        v-if=\"!isLogin\"\r\n        @click=\"handleLogin\"\r\n        :underline=\"false\">\r\n      登录\r\n    </el-link>\r\n\r\n    <el-dropdown class=\"login-dropdown\" v-if=\"isLogin\">\r\n      <el-button type=\"text\">\r\n        <div class=\"login-name\">\r\n          {{ user.nickname }}\r\n        </div>\r\n        <el-avatar :src=\"user.avatar\" @error=\"errorHandler\">\r\n          <!-- 当图片加载错误时，将加载这里面的图片 -->\r\n          <img src=\"../../assets/default_avatar.png\" alt=\"default avatar\"/>\r\n        </el-avatar>\r\n      </el-button>\r\n\r\n      <template #dropdown>\r\n        <el-dropdown-menu>\r\n          <el-dropdown-item>\r\n            <el-link :underline=\"false\" @click=\"show('personal')\" style=\"padding-right: 7px\">\r\n              <i style=\"padding-right: 3px\"></i>我的主页\r\n            </el-link>\r\n          </el-dropdown-item>\r\n          <el-dropdown-item>\r\n            <el-link :underline=\"false\" @click=\"show('personalPlanet')\" style=\"padding-right: 7px\">\r\n              <i style=\"padding-right: 3px\"></i>电影星球\r\n            </el-link>\r\n          </el-dropdown-item>\r\n          <el-dropdown-item>\r\n            <el-link :underline=\"false\" @click=\"show('setting')\" style=\"padding-right: 7px\">\r\n              <i style=\"padding-right: 3px\"></i>个人设置\r\n            </el-link>\r\n          </el-dropdown-item>\r\n          <el-dropdown-item divided>\r\n            <el-button type=\"text\" @click=\"handleLogout\" :underline=\"false\">\r\n              <i style=\"padding-right: 3px\"></i>退出登录\r\n            </el-button>\r\n          </el-dropdown-item>\r\n        </el-dropdown-menu>\r\n      </template>\r\n    </el-dropdown>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport {onBeforeMount, onBeforeUnmount, reactive, ref, watch} from \"vue\";\r\nimport {useRouter} from 'vue-router'\r\nimport {More, MoreFilled, Menu as MenuIcon} from \"@element-plus/icons\";\r\nimport userRequest from \"@/api/user\";\r\nimport {ErrorMessage, SuccessMessage} from \"@/utils/my-message\";\r\nimport emitter from \"@/utils/event-bus\";\r\nimport movieRequest from \"@/api/movie\";\r\nimport {Search} from \"@element-plus/icons-vue\";\r\n\r\nexport default {\r\n  name: \"MovieHeader\",\r\n  components: {Search, MoreFilled, More, MenuIcon},\r\n  setup() {\r\n    const router = useRouter()\r\n    let isLogin = ref(false)\r\n    let isShowMenu = ref(false);\r\n    let mainMenuRef = ref(null);\r\n    let moreRef = ref(null);\r\n    let moreFilledRef = ref(null);\r\n    let iconColor = ref('white')\r\n    let user = reactive({\r\n      id: 0,\r\n      nickname: '',\r\n      avatar: '',\r\n      sex: '',\r\n    })\r\n\r\n    // 展示名为name的页面\r\n    let show = (name) => {\r\n      router.push({\r\n        name: name\r\n      })\r\n      isShowMenu.value = false;\r\n    }\r\n\r\n    // 控制主菜单显示\r\n    let handleMainMenu = () => {\r\n      isShowMenu.value = !isShowMenu.value;\r\n    }\r\n    // 监测主菜单显示变量，根据展示与否改变图标颜色\r\n    watch(isShowMenu, (newValue, oldValue) => {\r\n      if (newValue === true) {\r\n        iconColor.value = '#a99f9f';\r\n      } else {\r\n        iconColor.value = 'white'\r\n      }\r\n    })\r\n\r\n    // 跳转到登录界面\r\n    let handleLogin = () => {\r\n      router.push('/login');\r\n    }\r\n\r\n    // 登出\r\n    let handleLogout = () => {\r\n      userRequest.logout().then(res => {\r\n        if (res.code === 200) {\r\n          SuccessMessage(res.msg)\r\n          // 用户注销时将缓存中的token和userInfo删除\r\n          localStorage.removeItem('token')\r\n          localStorage.removeItem('userInfo')\r\n          isLogin.value = false\r\n          router.replace({\r\n            name: 'home'\r\n          })\r\n        } else {\r\n          ErrorMessage(res.msg)\r\n        }\r\n      }).catch(err => {\r\n        ErrorMessage(err)\r\n      })\r\n    }\r\n\r\n    /**\r\n     * 每次初始化界面是判断token是否过期，如果没有过期，则显示登录基本信息\r\n     */\r\n    userRequest.getUserInfo().then(res => {\r\n      if (res.code === 200) {\r\n        isLogin.value = true\r\n        let userInfo = res.data\r\n        user.nickname = userInfo.nickname\r\n        user.id = userInfo.id\r\n        user.avatar = userInfo.avatar\r\n        user.sex = userInfo.sex\r\n      } else {\r\n        isLogin.value = false\r\n      }\r\n    }).catch(err => {\r\n      console.log(err)\r\n      console.error(err)\r\n    })\r\n\r\n    /**\r\n     * 图片错误句柄\r\n     * @returns {boolean}\r\n     */\r\n    const errorHandler = () => true\r\n\r\n    /**\r\n     * 监听nickname和avatar的改变\r\n     */\r\n    emitter.on('handleHeaderNicknameChange', data => {\r\n      user.nickname = data.nickname\r\n    })\r\n    emitter.on('handleHeaderAvatarChange', data => {\r\n      user.avatar = data.avatar\r\n    })\r\n\r\n    /**\r\n     * 将搜索记录存储到localStorage中\r\n     * @param keyword 搜索关键词\r\n     */\r\n    function storeHistorySearchRecords(keyword) {\r\n      let records = JSON.parse(localStorage.getItem(\"historySearchRecords\"));\r\n      if (records === null || records.length === 0) {\r\n        records = []\r\n      }\r\n      keyword = keyword.trim()\r\n      // 将搜索记录中和keyword相同的关键词过滤掉\r\n      records = records.filter((record) => {\r\n        return record !== keyword;\r\n      })\r\n      // 不将空白搜索关键词插入\r\n      if (keyword.trim().length !== 0) {\r\n        // 将keyword插入到搜索记录的开头\r\n        records.unshift(keyword);\r\n      }\r\n      // 最多保留10条搜索记录\r\n      const len = Math.min(10, records.length);\r\n      // 将搜索记录保存到localStorage中\r\n      localStorage.setItem(\"historySearchRecords\", JSON.stringify(records.slice(0, len)));\r\n    }\r\n\r\n    // 搜索\r\n    let searchKeywords = ref('')\r\n    const querySearchAsync = (queryString, cb) => {\r\n      movieRequest.getMatchMovieName(searchKeywords.value).then(res => {\r\n        if (res.code === 200) {\r\n          const result = []\r\n          res.data.forEach((name, index) => {\r\n            result.push({'value': name})\r\n          })\r\n          if (!result.length) {\r\n            const historySearchRecords = JSON.parse(localStorage.getItem(\"historySearchRecords\"));\r\n            historySearchRecords.forEach((name, index) => {\r\n              result.push({'value': name})\r\n            })\r\n          }\r\n          // 调用 callback 返回建议列表的数据\r\n          cb(result)\r\n        }\r\n      }).catch(err => {\r\n        console.error(err)\r\n      })\r\n    }\r\n    const handleSearch = () => {\r\n      isShowMenu.value = false\r\n      router.push({\r\n        name: 'classification',\r\n        query: {\r\n          keywords: searchKeywords.value\r\n        }\r\n      })\r\n      /**\r\n       * 全局事件总线\r\n       * 触发MovieCards里面的事件，搜索电影\r\n       */\r\n      emitter.emit('handleSearch', {\r\n        searchKeywords: searchKeywords.value\r\n      })\r\n      // 将搜索关键词保存到localStorage中\r\n      storeHistorySearchRecords(searchKeywords.value)\r\n    }\r\n    const handleSelect = (item) => {\r\n      searchKeywords.value = item.value\r\n      handleSearch()\r\n    }\r\n\r\n    onBeforeUnmount(() => {\r\n      emitter.off('handleHeaderNicknameChange')\r\n      emitter.off('handleEditAvatarChange')\r\n    })\r\n\r\n    return {\r\n      isLogin,\r\n      isShowMenu,\r\n      mainMenuRef,\r\n      moreFilledRef,\r\n      iconColor,\r\n      moreRef,\r\n      user,\r\n      show,\r\n      handleMainMenu,\r\n      handleLogin,\r\n      handleLogout,\r\n      errorHandler,\r\n      searchKeywords,\r\n      querySearchAsync,\r\n      handleSearch,\r\n      handleSelect\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n/* 设置顶部导航栏样式 */\r\n.navbar {\r\n  z-index: 500;\r\n  height: 50px;\r\n  padding-left: 10%;\r\n  padding-right: 10%;\r\n  display: flex;\r\n  background-color: rgb(84, 92, 100);\r\n}\r\n\r\n/*系统logo图片和字体样式*/\r\n.logo {\r\n  display: flex;\r\n  align-items: center;\r\n  height: 50px;\r\n\r\n  img {\r\n    padding-top: 5px;\r\n    width: 40px;\r\n    height: 40px;\r\n  }\r\n\r\n  .title {\r\n    color: #dddddd;\r\n    font-size: 30px;\r\n  }\r\n}\r\n\r\n.menu-icon {\r\n  display: none;\r\n}\r\n\r\n.big-menu {\r\n  display: flex;\r\n}\r\n\r\n.menu {\r\n  display: none;\r\n}\r\n\r\n/* 设置导航条链接演示 */\r\n.navbar a {\r\n  font-size: 20px;\r\n  color: white;\r\n\r\n  padding: 12px 20px;\r\n  text-decoration: none;\r\n  text-align: center;\r\n}\r\n\r\n/* 更改鼠标悬停时的颜色 */\r\n.navbar a:hover {\r\n  color: white;\r\n  animation: heartBeat;\r\n  animation-duration: .7s;\r\n}\r\n\r\n/*搜索框样式*/\r\n.search-div {\r\n  width: 300px;\r\n  padding-top: 10px;\r\n  text-align: center;\r\n}\r\n\r\n/*登录样式*/\r\n.login-link {\r\n  margin-left: auto; /*右对齐*/\r\n}\r\n\r\n/*登录成功抽屉样式*/\r\n.login-dropdown {\r\n  margin-top: auto;\r\n  margin-bottom: auto;\r\n  margin-left: auto;\r\n\r\n  /*登录用户名样式*/\r\n\r\n  .login-name {\r\n    font-weight: bolder;\r\n    font-size: 15px;\r\n    letter-spacing: 2px;\r\n  }\r\n}\r\n\r\n/* 响应式布局 - 当屏幕小于 740 像素宽 */\r\n@media screen and (max-width: 740px) {\r\n  .navbar {\r\n    z-index: 999;\r\n    padding: 0 1rem;\r\n  }\r\n\r\n  .menu-icon {\r\n    order: 1;\r\n    display: block;\r\n    width: 2rem;\r\n    height: 2rem;\r\n    position: relative;\r\n    margin: auto 0;\r\n  }\r\n\r\n  .big-menu {\r\n    display: none;\r\n  }\r\n\r\n  .menu {\r\n    order: 5;\r\n    position: absolute;\r\n    left: 0;\r\n    top: 50px;\r\n    width: 100%;\r\n    z-index: 500;\r\n    background-color: #333;\r\n    flex-direction: column;\r\n    display: flex;\r\n\r\n    .search-div {\r\n      margin-left: auto;\r\n      margin-right: auto;\r\n      margin-bottom: 10px;\r\n    }\r\n  }\r\n\r\n  .logo {\r\n    position: absolute;\r\n    left: 45%;\r\n\r\n    .title {\r\n      display: none;\r\n    }\r\n  }\r\n\r\n  .login-link, .login-dropdown {\r\n    order: 3;\r\n  }\r\n\r\n  .menu-enter-active {\r\n    animation: show-menu 0.5s linear;\r\n  }\r\n\r\n  .menu-leave-active {\r\n    animation: show-menu 0.5s reverse;\r\n  }\r\n\r\n  @keyframes show-menu {\r\n    from {\r\n      z-index: -100;\r\n      transform: translateY(-100%);\r\n    }\r\n\r\n    to {\r\n      z-index: 500;\r\n      transform: translateY(0%);\r\n    }\r\n  }\r\n}\r\n\r\n/* 响应式布局 - 当屏幕为（740px < 屏幕像素 < 1200px)宽 时，系统名消失，并且左右内边距变为0 */\r\n@media screen and (min-width: 740px) and  (max-width: 1200px) {\r\n  /* 左右内边距变为0 */\r\n  .navbar {\r\n    padding-left: 0;\r\n    padding-right: 0;\r\n  }\r\n\r\n  /* logo名消失 */\r\n  .logo .title {\r\n    display: none;\r\n  }\r\n\r\n  .big-menu {\r\n    display: flex;\r\n  }\r\n\r\n  .menu {\r\n    display: none;\r\n  }\r\n}\r\n</style>"]},"metadata":{},"sourceType":"module"}