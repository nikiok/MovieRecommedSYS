{"ast":null,"code":"import { Lock as IconLock, User as IconUser } from \"@element-plus/icons\";\nimport { reactive, ref, unref } from \"vue\";\nimport { useRouter } from \"vue-router\";\nimport { ErrorMessage, SuccessMessage } from \"@/utils/my-message\";\nimport userRequest from \"@/api/user\";\nimport { debounce } from \"@/utils/debounce-throttle\";\nexport default {\n  name: 'LoginView',\n  components: {\n    IconUser,\n    IconLock\n  },\n  setup() {\n    const router = useRouter();\n    let remember = ref(false);\n    const loginFormRef = ref('');\n    const loginForm = reactive({\n      username: '',\n      password: ''\n    });\n    const rules = reactive({\n      username: [{\n        required: true,\n        message: '请输入账号',\n        trigger: 'blur'\n      }, {\n        min: 4,\n        max: 20,\n        message: '长度在4到20个字符',\n        trigger: 'blur'\n      }],\n      password: [{\n        required: true,\n        message: '请输入密码',\n        trigger: 'blur'\n      }, {\n        min: 4,\n        max: 20,\n        message: '长度在4到20个字符',\n        trigger: 'blur'\n      }]\n    });\n    const postLogin = debounce(async () => {\n      const form = unref(loginFormRef);\n      if (!form) {\n        return;\n      }\n      try {\n        await form.validate();\n        userRequest.login(loginForm).then(res => {\n          if (res.code === 200) {\n            localStorage.setItem(\"token\", res.data.token);\n            localStorage.setItem(\"userInfo\", JSON.stringify(res.data.userInfo));\n            SuccessMessage(res.msg);\n            // 登录成功之后，进行页面跳转\n            router.replace(\"/\");\n          } else {\n            ErrorMessage(res.msg);\n          }\n        }).catch(err => {\n          ErrorMessage(err);\n        });\n      } catch (err) {\n        console.log(err);\n      }\n    });\n    return {\n      remember,\n      loginFormRef,\n      loginForm,\n      rules,\n      postLogin\n    };\n  }\n};","map":{"version":3,"mappings":"AAyEA,SAAQA,IAAG,IAAKC,QAAQ,EAAEC,IAAG,IAAKC,QAAQ,QAAO,qBAAqB;AACtE,SAAQC,QAAQ,EAAEC,GAAG,EAAEC,KAAK,QAAO,KAAK;AACxC,SAAQC,SAAS,QAAO,YAAY;AACpC,SAAQC,YAAY,EAAEC,cAAc,QAAO,oBAAoB;AAC/D,OAAOC,WAAU,MAAO,YAAY;AACpC,SAAQC,QAAQ,QAAO,2BAA2B;AAElD,eAAe;EACbC,IAAI,EAAE,WAAW;EACjBC,UAAU,EAAE;IACVV,QAAQ;IACRF;EACF,CAAC;EACDa,KAAKA,GAAG;IACN,MAAMC,MAAK,GAAIR,SAAS,CAAC;IACzB,IAAIS,QAAO,GAAIX,GAAG,CAAC,KAAK;IACxB,MAAMY,YAAW,GAAIZ,GAAG,CAAC,EAAE;IAE3B,MAAMa,SAAQ,GAAId,QAAQ,CAAC;MACzBe,QAAQ,EAAE,EAAE;MACZC,QAAQ,EAAE;IACZ,CAAC;IAED,MAAMC,KAAI,GAAIjB,QAAQ,CAAC;MACrBe,QAAQ,EAAE,CACR;QAACG,QAAQ,EAAE,IAAI;QAAEC,OAAO,EAAE,OAAO;QAAEC,OAAO,EAAE;MAAM,CAAC,EACnD;QAACC,GAAG,EAAE,CAAC;QAAEC,GAAG,EAAE,EAAE;QAAEH,OAAO,EAAE,YAAY;QAAEC,OAAO,EAAE;MAAM,EACzD;MACDJ,QAAQ,EAAE,CACR;QAACE,QAAQ,EAAE,IAAI;QAAEC,OAAO,EAAE,OAAO;QAAEC,OAAO,EAAE;MAAM,CAAC,EACnD;QAACC,GAAG,EAAE,CAAC;QAAEC,GAAG,EAAE,EAAE;QAAEH,OAAO,EAAE,YAAY;QAAEC,OAAO,EAAE;MAAM;IAE5D,CAAC;IAED,MAAMG,SAAQ,GAAIhB,QAAQ,CAAC,YAAY;MACrC,MAAMiB,IAAG,GAAItB,KAAK,CAACW,YAAY;MAC/B,IAAI,CAACW,IAAI,EAAE;QACT;MACF;MACA,IAAI;QACF,MAAMA,IAAI,CAACC,QAAQ,CAAC;QACpBnB,WAAW,CAACoB,KAAK,CAACZ,SAAS,CAAC,CAACa,IAAI,CAACC,GAAE,IAAK;UACvC,IAAIA,GAAG,CAACC,IAAG,KAAM,GAAG,EAAE;YACpBC,YAAY,CAACC,OAAO,CAAC,OAAO,EAAEH,GAAG,CAACI,IAAI,CAACC,KAAK;YAC5CH,YAAY,CAACC,OAAO,CAAC,UAAU,EAAEG,IAAI,CAACC,SAAS,CAACP,GAAG,CAACI,IAAI,CAACI,QAAQ,CAAC;YAClE/B,cAAc,CAACuB,GAAG,CAACS,GAAG;YACtB;YACA1B,MAAM,CAAC2B,OAAO,CAAC,GAAG;UACpB,OAAO;YACLlC,YAAY,CAACwB,GAAG,CAACS,GAAG;UACtB;QACF,CAAC,CAAC,CAACE,KAAK,CAACC,GAAE,IAAK;UACdpC,YAAY,CAACoC,GAAG;QAClB,CAAC;MACH,EAAE,OAAOA,GAAG,EAAE;QACZC,OAAO,CAACC,GAAG,CAACF,GAAG;MACjB;IACF,CAAC;IAED,OAAO;MACL5B,QAAQ;MACRC,YAAY;MACZC,SAAS;MACTG,KAAK;MACLM;IACF;EACF;AACF","names":["Lock","IconLock","User","IconUser","reactive","ref","unref","useRouter","ErrorMessage","SuccessMessage","userRequest","debounce","name","components","setup","router","remember","loginFormRef","loginForm","username","password","rules","required","message","trigger","min","max","postLogin","form","validate","login","then","res","code","localStorage","setItem","data","token","JSON","stringify","userInfo","msg","replace","catch","err","console","log"],"sourceRoot":"","sources":["F:\\personalSpace\\lx-bishe\\movie_recommendation_system_vue\\src\\views\\LoginView.vue"],"sourcesContent":["<template>\r\n  <!--  <div class=\"bg\" style=\"background-image: url('https://api.xygeng.cn/Bing/')\"></div>-->\r\n  <div class=\"bg\"></div>\r\n  <div\r\n      name=\"animate__bounce\"\r\n      class=\"login-form my-border\"\r\n      @keyup.enter=\"postLogin\"\r\n  >\r\n\r\n    <div class=\"login-form-header\">\r\n      <router-link to=\"/home\">\r\n        <img style=\"width: 75px; height: 75px; float: left; padding-right: 40px;\" src=\"../assets/logo.png\" alt=\"logo\"/>\r\n      </router-link>\r\n\r\n      <div class=\"login-form-text\">电影推荐系统 - 登录</div>\r\n    </div>\r\n\r\n    <el-form ref=\"loginFormRef\" :model=\"loginForm\" :rules=\"rules\">\r\n      <el-form-item label=\"账 号\" prop=\"username\">\r\n        <el-input\r\n            class=\"login-form-input\"\r\n            placeholder=\"账 号\"\r\n            v-model=\"loginForm.username\"\r\n            autofocus\r\n            autocomplete=\"off\"\r\n        >\r\n          <template #prefix>\r\n            <el-icon class=\"el-input__icon\">\r\n              <icon-user/>\r\n            </el-icon>\r\n          </template>\r\n        </el-input>\r\n      </el-form-item>\r\n\r\n      <el-form-item label=\"密 码\" prop=\"password\">\r\n        <el-input\r\n            class=\"login-form-input\"\r\n            placeholder=\"密 码\"\r\n            v-model=\"loginForm.password\"\r\n            show-password\r\n        >\r\n          <template #prefix>\r\n            <el-icon class=\"el-input__icon\">\r\n              <icon-lock/>\r\n            </el-icon>\r\n          </template>\r\n        </el-input>\r\n      </el-form-item>\r\n\r\n      <div class=\"scan-and-forget-div\">\r\n        <!--        <el-link href=\"/scanLogin\" class=\"my-font\" :underline=\"false\">-->\r\n        <!--          扫码登录-->\r\n        <!--        </el-link>-->\r\n        <el-link href=\"/forget\" class=\"my-font\" :underline=\"false\">\r\n          忘记密码?\r\n        </el-link>\r\n      </div>\r\n\r\n      <el-form-item>\r\n        <el-button @click=\"postLogin\" class=\"login-form-button\" type=\"primary\">登 录</el-button>\r\n      </el-form-item>\r\n    </el-form>\r\n\r\n    <div class=\"login-form-footer\">\r\n      <el-link href=\"/register\" class=\"my-font\" style=\"font-size: 16px\" :underline=\"false\">\r\n        还没有账号？去注册\r\n        <i style=\"font-weight: bolder; font-size: 15px\" class=\"el-icon-right\"></i>\r\n      </el-link>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport {Lock as IconLock, User as IconUser} from \"@element-plus/icons\";\r\nimport {reactive, ref, unref} from \"vue\";\r\nimport {useRouter} from \"vue-router\";\r\nimport {ErrorMessage, SuccessMessage} from \"@/utils/my-message\";\r\nimport userRequest from \"@/api/user\";\r\nimport {debounce} from \"@/utils/debounce-throttle\";\r\n\r\nexport default {\r\n  name: 'LoginView',\r\n  components: {\r\n    IconUser,\r\n    IconLock,\r\n  },\r\n  setup() {\r\n    const router = useRouter()\r\n    let remember = ref(false)\r\n    const loginFormRef = ref('')\r\n\r\n    const loginForm = reactive({\r\n      username: '',\r\n      password: '',\r\n    })\r\n\r\n    const rules = reactive({\r\n      username: [\r\n        {required: true, message: '请输入账号', trigger: 'blur'},\r\n        {min: 4, max: 20, message: '长度在4到20个字符', trigger: 'blur'}\r\n      ],\r\n      password: [\r\n        {required: true, message: '请输入密码', trigger: 'blur'},\r\n        {min: 4, max: 20, message: '长度在4到20个字符', trigger: 'blur'}\r\n      ],\r\n    })\r\n\r\n    const postLogin = debounce(async () => {\r\n      const form = unref(loginFormRef)\r\n      if (!form) {\r\n        return\r\n      }\r\n      try {\r\n        await form.validate()\r\n        userRequest.login(loginForm).then(res => {\r\n          if (res.code === 200) {\r\n            localStorage.setItem(\"token\", res.data.token)\r\n            localStorage.setItem(\"userInfo\", JSON.stringify(res.data.userInfo))\r\n            SuccessMessage(res.msg)\r\n            // 登录成功之后，进行页面跳转\r\n            router.replace(\"/\")\r\n          } else {\r\n            ErrorMessage(res.msg)\r\n          }\r\n        }).catch(err => {\r\n          ErrorMessage(err)\r\n        })\r\n      } catch (err) {\r\n        console.log(err)\r\n      }\r\n    })\r\n\r\n    return {\r\n      remember,\r\n      loginFormRef,\r\n      loginForm,\r\n      rules,\r\n      postLogin,\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n.bg {\r\n  height: 100%;\r\n  width: 100%;\r\n  position: absolute;\r\n  background-size: cover;\r\n}\r\n\r\n.login-form {\r\n  width: 28rem;\r\n  position: absolute;\r\n  left: 50%;\r\n  top: 10rem;\r\n  transform: translate(-50%, 0);\r\n  padding: 2rem;\r\n  margin-top: 1rem;\r\n  letter-spacing: 2px;\r\n}\r\n\r\n.login-form-header {\r\n  height: 20px;\r\n  padding-left: 45px;\r\n  padding-bottom: 100px;\r\n}\r\n\r\n.login-form-text {\r\n  color: #000000;\r\n  font-weight: bold;\r\n  font-size: 1.8rem;\r\n  padding-top: 15px;\r\n}\r\n\r\n.login-form-input {\r\n  margin-bottom: 10px;\r\n}\r\n\r\n.login-form-button {\r\n  border-radius: 3px;\r\n  width: 100%;\r\n  font-weight: 600;\r\n  font-size: 15px;\r\n  letter-spacing: 2px;\r\n  height: 3.5rem;\r\n  background: #5a84fd;\r\n  margin-top: 35px;\r\n}\r\n\r\n.login-form-button:hover {\r\n  box-shadow: 0 10px 30px #2156f6;\r\n  transition: 3s;\r\n}\r\n\r\n.scan-and-forget-div {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  margin-top: 10px;\r\n}\r\n\r\n.my-font {\r\n  font-weight: bolder;\r\n  font-size: 14px;\r\n  color: #91949c;\r\n}\r\n\r\n.my-font:hover {\r\n  color: #5a84fd;\r\n}\r\n\r\n.login-form-footer {\r\n  font-weight: bolder;\r\n  color: #91949c;\r\n  padding-top: 1.5rem;\r\n  text-align: center;\r\n}\r\n\r\n/deep/ .el-input__inner {\r\n  height: 3rem;\r\n}\r\n\r\n.el-checkbox {\r\n  color: #91949c;\r\n  font-weight: bolder;\r\n  font-size: 15px;\r\n}\r\n\r\n/deep/ .el-form-item__label {\r\n  color: #91949c;\r\n  font-weight: bold;\r\n}\r\n\r\n/deep/ .el-form-item {\r\n  align-items: baseline;\r\n}\r\n\r\n.bg-change {\r\n  background-color: #e74c3c;\r\n  animation: bg-color 20s infinite;\r\n  -webkit-animation: bg-color 20s infinite;\r\n}\r\n\r\n@-webkit-keyframes bg-color {\r\n  0% {\r\n    background-color: #f18f87;\r\n  }\r\n  20% {\r\n    background-color: #ead18c;\r\n  }\r\n  40% {\r\n    background-color: #8be1d1;\r\n  }\r\n  60% {\r\n    background-color: #8cbee1;\r\n  }\r\n  80% {\r\n    background-color: #cba2e1;\r\n  }\r\n  100% {\r\n    background-color: #f18f87;\r\n  }\r\n}\r\n\r\n@keyframes bg-color {\r\n  0% {\r\n    background-color: #f18f87;\r\n  }\r\n  20% {\r\n    background-color: #ead18c;\r\n  }\r\n  40% {\r\n    background-color: #8be1d1;\r\n  }\r\n  60% {\r\n    background-color: #8cbee1;\r\n  }\r\n  80% {\r\n    background-color: #cba2e1;\r\n  }\r\n  100% {\r\n    background-color: #f18f87;\r\n  }\r\n}\r\n</style>\r\n"]},"metadata":{},"sourceType":"module"}